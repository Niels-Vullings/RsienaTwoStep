<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="RsienaTwoStep">
<title>RSienaWorkFlow • RsienaTwoStep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RSienaWorkFlow">
<meta property="og:description" content="RsienaTwoStep">
<meta property="og:image" content="https://jochemtolsma.github.io/RsienaTwoStep/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RsienaTwoStep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Introduction_RsienaTwoStep.html">Introduction_RsienaTwoStep</a>
    <a class="dropdown-item" href="../articles/MinistepToTwoStep.html">MinistepToTwostep</a>
    <a class="dropdown-item" href="../articles/RsienaWorkflow.html">RSienaWorkFlow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JochemTolsma/RsienaTwoStep/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="RsienaWorkflow_files/kePrint-0.0.1/kePrint.js"></script><link href="RsienaWorkflow_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>RSienaWorkFlow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JochemTolsma/RsienaTwoStep/blob/HEAD/vignettes/articles/RsienaWorkflow.Rmd" class="external-link"><code>vignettes/articles/RsienaWorkflow.Rmd</code></a></small>
      <div class="d-none name"><code>RsienaWorkflow.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.test {
  max-height: 300px;
  overflow-y: auto;
  overflow-x: auto;
  margin: 10px;
}

.test2 {
  max-height: 300px;
  overflow-y: auto;
  overflow-x: auto;
  margin: 10px;
  background-color: white;
  color: rgb(201, 76, 76);
}


h1, .h1, h2, .h2, h3, .h3 {
  margin-top: 24px;
}





.button1 {
  background-color: grey; /* Red */ 
  border: 2px solid black;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
  /* border-radius: 12px; */
  width: 100%;
}

.button1:hover {
  box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);
}

.button1:active {
  border: 2px solid red;
}

pre {
  max-height: 300px;
  overflow-y: auto;
  overflow-x: auto;
  margin: 0px;
}

.watch-out {
  background-color: lightpink;
  border: 3px solid red;
  font-weight: bold;
}

.large {
  max-height: 1100px;
  overflow-y: auto;
  overflow-x: auto;
  width: 1100px;
}


body{ /* Normal  */
    font-size: 14px;
}

h1 { /* Header 1 */
    font-size: 20px;
  font-weight: bold;
}

h2 { /* Header 2 */
    font-size: 18px;
  color: DarkBlue;
}

h3 { /* Header 3 */
    font-size: 16px;
  color: DarkBlue;
}

blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 14px;
  border-left: 6px solid #eee;
  background-color:lightcyan
}

caption {
  font-size: 14px;
  color: black;
  font-weight: bold
}

pre.numberSource a.sourceLine {
  left: -1em;
}

</style>
<div class="section level2">
<h2 id="getting-started">1. Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="basic-functions">1.1. Basic functions<a class="anchor" aria-label="anchor" href="#basic-functions"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fsave</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">file</span>, <span class="va">location</span> <span class="op">=</span> <span class="st">"./data/processed/"</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span></span>
<span>    <span class="va">datename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[:-]"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>    <span class="va">totalname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">location</span>, <span class="va">datename</span>, <span class="va">file</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SAVED: "</span>, <span class="va">totalname</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">x</span>, file <span class="op">=</span> <span class="va">totalname</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fpackage.check</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">packages</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">packages</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">x</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">x</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">x</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">colorize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">color</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"&lt;span style='color: %s;'&gt;%s&lt;/span&gt;"</span>, <span class="va">color</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fshowdf</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fl">3</span>, <span class="st">"html"</span>, <span class="va">...</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html" class="external-link">scroll_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"600px"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="packages">1.2. Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">packages</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RsienaTwoStep"</span>, <span class="st">"RSiena"</span>, <span class="st">"doParallel"</span>, <span class="st">"compiler"</span>, <span class="st">"ggplot2"</span>, <span class="st">"tidyverse"</span>, <span class="st">"kableExtra"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">fpackage.check</span><span class="op">(</span><span class="va">packages</span><span class="op">)</span></span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-cluster">2. Setting up cluster<a class="anchor" aria-label="anchor" href="#setting-up-cluster"></a>
</h2>
<!---
to do change to dofuture
https://www.r-bloggers.com/2023/06/dofuture-a-better-foreach-parallelization-operator-than-dopar/
--->
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">no_cores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">mycl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"localhost"</span>, <span class="va">no_cores</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">mycl</span>, <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JochemTolsma/RsienaTwoStep" class="external-link">RsienaTwoStep</a></span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">mycl</span>, <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://statnet.org/" class="external-link">"network"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">mycl</span>, <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://www.stats.ox.ac.uk/~snijders/siena/" class="external-link">"RSiena"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">mycl</span>, <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://statnet.org" class="external-link">"sna"</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">mycl</span><span class="op">)</span></span>
<span><span class="co">#stopCluster(cl = mycl)</span></span>
<span></span>
<span></span>
<span><span class="co">#perhaps this is better (backend independent):</span></span>
<span><span class="co"># library(doFuture)</span></span>
<span><span class="co"># doFuture::registerDoFuture()</span></span>
<span><span class="co"># future::plan("multisession", workers = detectCores() - 1)</span></span>
<span><span class="co">## Explicitly close multisession workers by switching plan</span></span>
<span><span class="co"># plan(sequential)</span></span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="running-siena07">3. Running <code>Siena07()</code><a class="anchor" aria-label="anchor" href="#running-siena07"></a>
</h2>
<div class="section level3">
<h3 id="prepare-the-dataset">3.1. Prepare the dataset<a class="anchor" aria-label="anchor" href="#prepare-the-dataset"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mynet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDependent.html" class="external-link">sienaDependent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">s501</span>, <span class="va">s502</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">alcohol</span> <span class="op">&lt;-</span> <span class="va">s50a</span></span>
<span><span class="va">smoke</span> <span class="op">&lt;-</span> <span class="va">s50s</span></span>
<span><span class="va">smoke</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/coCovar.html" class="external-link">coCovar</a></span><span class="op">(</span><span class="va">smoke</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">alcohol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/coCovar.html" class="external-link">coCovar</a></span><span class="op">(</span><span class="va">alcohol</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDataCreate.html" class="external-link">sienaDataCreate</a></span><span class="op">(</span><span class="va">mynet</span>, <span class="va">smoke</span>, <span class="va">alcohol</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="set-up-up-the-algorithm-">3.2. Set up up the algorithm.<a class="anchor" aria-label="anchor" href="#set-up-up-the-algorithm-"></a>
</h3>
<p>Set conditional to <code>FALSE</code>, this way we estimate the rate
parameter and I will be able to retrieve the rate parameter estimate in
theta. Also set ‘findiff’ to <code>TRUE</code>. In
<code>RsienaTwoStep</code> the estimates of derivatives (phase1 and
phase3) are estimated using finite differences.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myalgorithm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaAlgorithmCreate.html" class="external-link">sienaAlgorithmCreate</a></span><span class="op">(</span>cond <span class="op">=</span> <span class="cn">FALSE</span>, findiff <span class="op">=</span> <span class="cn">TRUE</span>, projname<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="define-the-model">3.3. Define the model<a class="anchor" aria-label="anchor" href="#define-the-model"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/getEffects.html" class="external-link">getEffects</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">cycle3</span>, <span class="va">transTrip</span><span class="op">)</span></span>
<span><span class="co">#&gt;   effectName          include fix   test  initialValue parm</span></span>
<span><span class="co">#&gt; 1 transitive triplets TRUE    FALSE FALSE          0   0   </span></span>
<span><span class="co">#&gt; 2 3-cycles            TRUE    FALSE FALSE          0   0</span></span>
<span><span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">egoX</span>, <span class="va">altX</span>, <span class="va">egoXaltX</span>, interaction1 <span class="op">=</span> <span class="st">"alcohol"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   effectName                  include fix   test  initialValue parm</span></span>
<span><span class="co">#&gt; 1 alcohol alter               TRUE    FALSE FALSE          0   0   </span></span>
<span><span class="co">#&gt; 2 alcohol ego                 TRUE    FALSE FALSE          0   0   </span></span>
<span><span class="co">#&gt; 3 alcohol ego x alcohol alter TRUE    FALSE FALSE          0   0</span></span>
<span><span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">simX</span>, interaction1 <span class="op">=</span> <span class="st">"smoke"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   effectName       include fix   test  initialValue parm</span></span>
<span><span class="co">#&gt; 1 smoke similarity TRUE    FALSE FALSE          0   0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimate-the-model-">3.4. Estimate the model.<a class="anchor" aria-label="anchor" href="#estimate-the-model-"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/siena07.html" class="external-link">siena07</a></span><span class="op">(</span><span class="va">myalgorithm</span>, data<span class="op">=</span><span class="va">mydata</span>, effects<span class="op">=</span><span class="va">myeff</span>, batch<span class="op">=</span><span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ans3</span>, file<span class="op">=</span><span class="st">"ans3.Rdata"</span><span class="op">)</span></span></code></pre></div>
<p>let’s have a look</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans3</span></span>
<span><span class="co">#&gt; Estimates, standard errors and convergence t-ratios</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                       Estimate   Standard   Convergence </span></span>
<span><span class="co">#&gt;                                                    Error      t-ratio   </span></span>
<span><span class="co">#&gt;   1. rate basic rate parameter mynet   6.2300  ( 1.0066   )    0.0453   </span></span>
<span><span class="co">#&gt;   2. eval outdegree (density)         -2.5205  ( 0.1434   )    0.0172   </span></span>
<span><span class="co">#&gt;   3. eval reciprocity                  2.0461  ( 0.2817   )   -0.0042   </span></span>
<span><span class="co">#&gt;   4. eval transitive triplets          0.5426  ( 0.1728   )    0.0046   </span></span>
<span><span class="co">#&gt;   5. eval 3-cycles                     0.0580  ( 0.3165   )    0.0103   </span></span>
<span><span class="co">#&gt;   6. eval smoke similarity             0.4123  ( 0.2805   )   -0.0141   </span></span>
<span><span class="co">#&gt;   7. eval alcohol alter               -0.0692  ( 0.0944   )    0.0433   </span></span>
<span><span class="co">#&gt;   8. eval alcohol ego                  0.0382  ( 0.0932   )    0.0488   </span></span>
<span><span class="co">#&gt;   9. eval alcohol ego x alcohol alter  0.0994  ( 0.0750   )   -0.0073   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Overall maximum convergence ratio:    0.0979 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Total of 2695 iteration steps.</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="estimate-via-rsienatwostep">4. Estimate via <code>RsienaTwoStep</code><a class="anchor" aria-label="anchor" href="#estimate-via-rsienatwostep"></a>
</h2>
<p>First we will demonstrate that we can estimate the same model without
using <code><a href="https://rdrr.io/pkg/RSiena/man/siena07.html" class="external-link">siena07()</a></code>.</p>
<div class="section level3">
<h3 id="prepare-the-dataset-1">4.1. Prepare the dataset<a class="anchor" aria-label="anchor" href="#prepare-the-dataset-1"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>alcohol <span class="op">=</span> <span class="va">s50a</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, smoke <span class="op">=</span> <span class="va">s50s</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>No need to set up an algorithm.</p>
</div>
<div class="section level3">
<h3 id="define-the-model-">4.2. Define the model.<a class="anchor" aria-label="anchor" href="#define-the-model-"></a>
</h3>
<p>Include all names of the statistics in a list. The aim is to use the
shortname of these effects as listed in the RSiena model with a prefix
“ts_” added to them. If the statistic requires a covariate use a list
with the first element the name of the statistic and the second element
the name of the covariate. This should be the same name as used in your
dataset.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">STATS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, </span>
<span>              <span class="va">ts_recip</span>, </span>
<span>              <span class="va">ts_transTrip</span>, </span>
<span>              <span class="va">ts_cycle3</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_simX</span>, <span class="st">"smoke"</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_altX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoXaltX</span>, <span class="st">"alcohol"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="check-statistics">4.2.1. Check statistics<a class="anchor" aria-label="anchor" href="#check-statistics"></a>
</h4>
<p>As a brief intermezzo, check if the statistics are programmed
correctly by comparing the target values.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_targets</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span> <span class="co">#target values calculated by `siena07()`</span></span>
<span><span class="va">t2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_targets</a></span><span class="op">(</span>mydata<span class="op">=</span><span class="va">mydata</span>, myeff<span class="op">=</span><span class="va">myeff</span><span class="op">)</span> <span class="co">#target values calculated by RsienaTwoStep based on RSiena objects. </span></span>
<span><span class="va">t3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_targets</a></span><span class="op">(</span>net1 <span class="op">=</span> <span class="va">s501</span>, net2 <span class="op">=</span> <span class="va">s502</span>, statistics <span class="op">=</span> <span class="va">STATS</span>, ccovar <span class="op">=</span> <span class="va">DF</span><span class="op">)</span> <span class="co">#target values calculated by RsienaTwoStep based on RsienaTwoStep objects.</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Siena_original <span class="op">=</span> <span class="va">t1</span>, ts_siena_objects <span class="op">=</span> <span class="va">t2</span>, ts_twostep_object <span class="op">=</span> <span class="va">t3</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">t3</span><span class="op">)</span></span>
<span><span class="fu">fshowdf</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:600px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Siena_original
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ts_siena_objects
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ts_twostep_object
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rate
</td>
<td style="text-align:right;">
115.000
</td>
<td style="text-align:right;">
115.000
</td>
<td style="text-align:right;">
115.000
</td>
</tr>
<tr>
<td style="text-align:left;">
degree
</td>
<td style="text-align:right;">
116.000
</td>
<td style="text-align:right;">
116.000
</td>
<td style="text-align:right;">
116.000
</td>
</tr>
<tr>
<td style="text-align:left;">
recip
</td>
<td style="text-align:right;">
70.000
</td>
<td style="text-align:right;">
70.000
</td>
<td style="text-align:right;">
70.000
</td>
</tr>
<tr>
<td style="text-align:left;">
transTrip
</td>
<td style="text-align:right;">
88.000
</td>
<td style="text-align:right;">
88.000
</td>
<td style="text-align:right;">
88.000
</td>
</tr>
<tr>
<td style="text-align:left;">
cycle3
</td>
<td style="text-align:right;">
28.000
</td>
<td style="text-align:right;">
28.000
</td>
<td style="text-align:right;">
28.000
</td>
</tr>
<tr>
<td style="text-align:left;">
simX smoke
</td>
<td style="text-align:right;">
13.842
</td>
<td style="text-align:right;">
13.842
</td>
<td style="text-align:right;">
13.842
</td>
</tr>
<tr>
<td style="text-align:left;">
altX alcohol
</td>
<td style="text-align:right;">
-4.080
</td>
<td style="text-align:right;">
-4.080
</td>
<td style="text-align:right;">
-4.080
</td>
</tr>
<tr>
<td style="text-align:left;">
egoX alcohol
</td>
<td style="text-align:right;">
2.920
</td>
<td style="text-align:right;">
2.920
</td>
<td style="text-align:right;">
2.920
</td>
</tr>
<tr>
<td style="text-align:left;">
egoXaltX alcohol
</td>
<td style="text-align:right;">
62.190
</td>
<td style="text-align:right;">
62.190
</td>
<td style="text-align:right;">
62.190
</td>
</tr>
</tbody>
</table>
</div>
<p><br> Everything is fine.</p>
</div>
</div>
<div class="section level3">
<h3 id="estimate-model">4.3. Estimate model<a class="anchor" aria-label="anchor" href="#estimate-model"></a>
</h3>
<div class="section level4">
<h4 id="estimate-parameters-">4.3.1. Estimate parameters.<a class="anchor" aria-label="anchor" href="#estimate-parameters-"></a>
</h4>
<p>We could estimate the parameters and the SE separately. This means we
need to set <code>phase3</code> to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_ans1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_estim</a></span><span class="op">(</span>net1 <span class="op">=</span> <span class="va">s501</span>, net2<span class="op">=</span> <span class="va">s502</span>, statistics <span class="op">=</span> <span class="va">STATS</span>, ccovar <span class="op">=</span> <span class="va">DF</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, phase3 <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We could also start with the data objects of RSiena. Note that we
still perform phase1 ourselves.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_ans1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_estim</a></span><span class="op">(</span>mydata <span class="op">=</span> <span class="va">mydata</span>, myeff <span class="op">=</span> <span class="va">myeff</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, phase3 <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>We could also start with the result of an
<code><a href="https://rdrr.io/pkg/RSiena/man/siena07.html" class="external-link">RSiena::siena07()</a></code> estimation. We now use the final
estimates as our starting values and as phase1 the results of phase3 as
stored in ans. This is (more or less) similar as to using prevAns in
RSiena.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_ans1c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_estim</a></span><span class="op">(</span>ans <span class="op">=</span> <span class="va">ans3</span>, phase3 <span class="op">=</span> <span class="cn">FALSE</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="check-convergence-visually">4.3.2. check convergence visually<a class="anchor" aria-label="anchor" href="#check-convergence-visually"></a>
</h4>
<p>let’s have a look if parameters converged.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">ts_ans1c</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">ite</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ans1c</span><span class="op">)</span></span>
<span><span class="co">#convert data from wide to long format</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span> <span class="fu">all_of</span><span class="op">(</span><span class="va">vars</span><span class="op">)</span>,</span>
<span>                          names_to<span class="op">=</span><span class="st">'statistic'</span>,</span>
<span>                          values_to<span class="op">=</span><span class="st">'estimate'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ite</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-21-1.png" width="700"><br> Let us zoom in a little on transTrip</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">ts_ans1c</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">ite</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ans1c</span><span class="op">)</span></span>
<span><span class="co">#convert data from wide to long format</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span> <span class="va">vars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                          names_to<span class="op">=</span><span class="st">'statistic'</span>,</span>
<span>                          values_to<span class="op">=</span><span class="st">'estimate'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ite</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-22-1.png" width="700"><br> And on the last 250 iterations or so.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">ts_ans1c</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">ite</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ans1c</span><span class="op">)</span></span>
<span><span class="co">#convert data from wide to long format</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="fl">750</span><span class="op">:</span><span class="fl">1000</span>,<span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span> <span class="va">vars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                          names_to<span class="op">=</span><span class="st">'statistic'</span>,</span>
<span>                          values_to<span class="op">=</span><span class="st">'estimate'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ite</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-23-1.png" width="700"><br></p>
<p>Well, what do you make out of this? If the lines keep oscillating
around a specific value, try to increase the <code>b</code> parameter.
Conversely, if the lines did not converge but you see no oscillation you
could decrease the <code>b</code> parameter. In this case, I think we
should/could increase b each 250 iterations or so.</p>
<p>You could also try to re-estimate the model with different starting
values.</p>
<p>I like to inspect the results of the Robbins Monro algorithm in this
way, before I go to phase3 because phase3 takes up quite some time.</p>
</div>
<div class="section level4">
<h4 id="estimate-se-tstats-and-tconv-max">4.3.3. Estimate SE, tstats and tconv.max<a class="anchor" aria-label="anchor" href="#estimate-se-tstats-and-tconv-max"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ESTIM</span> <span class="op">&lt;-</span> <span class="va">ts_ans1c</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ans1c</span><span class="op">)</span>,<span class="op">]</span> <span class="co">#we will take the last for now. </span></span>
<span><span class="va">ESTIM</span> <span class="op">&lt;-</span> <span class="va">ans3</span><span class="op">$</span><span class="va">theta</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ans1c_phase3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_phase3</a></span><span class="op">(</span>startvalues <span class="op">=</span> <span class="va">ESTIM</span>, net1 <span class="op">=</span> <span class="va">s501</span>, net2<span class="op">=</span> <span class="va">s502</span>, statistics <span class="op">=</span> <span class="va">STATS</span>, ccovar <span class="op">=</span> <span class="va">DF</span>, itef3 <span class="op">=</span> <span class="fl">1000</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="final-results">4.4 final results<a class="anchor" aria-label="anchor" href="#final-results"></a>
</h3>
<p>Let us have a look at the final results.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ans1c_phase3</span><span class="op">$</span><span class="va">covtheta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tstat</span> <span class="op">&lt;-</span> <span class="va">ans1c_phase3</span><span class="op">$</span><span class="va">tstat</span></span>
<span><span class="va">tconv.max</span> <span class="op">&lt;-</span> <span class="va">ans1c_phase3</span><span class="op">$</span><span class="va">tconv.max</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estim <span class="op">=</span> <span class="va">ESTIM</span>, SE <span class="op">=</span> <span class="va">SE</span>, <span class="st">"tratio"</span> <span class="op">=</span> <span class="va">tstat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df</span>, digits <span class="op">=</span> <span class="fl">3</span>, <span class="st">"html"</span>, escape<span class="op">=</span><span class="cn">FALSE</span>, col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Estimate"</span>, <span class="st">"Standard &lt;br&gt; Error"</span>, <span class="st">"Convergence &lt;br&gt; t-ratio"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html" class="external-link">scroll_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"500px"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/footnote.html" class="external-link">footnote</a></span><span class="op">(</span>general <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"tconv.max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tconv.max</span>, <span class="fl">3</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;border-bottom: 0;">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Standard <br> Error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Convergence <br> t-ratio
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rate
</td>
<td style="text-align:right;">
6.230
</td>
<td style="text-align:right;">
0.963
</td>
<td style="text-align:right;">
0.016
</td>
</tr>
<tr>
<td style="text-align:left;">
degree
</td>
<td style="text-align:right;">
-2.521
</td>
<td style="text-align:right;">
0.138
</td>
<td style="text-align:right;">
0.074
</td>
</tr>
<tr>
<td style="text-align:left;">
recip
</td>
<td style="text-align:right;">
2.046
</td>
<td style="text-align:right;">
0.243
</td>
<td style="text-align:right;">
0.099
</td>
</tr>
<tr>
<td style="text-align:left;">
transTrip
</td>
<td style="text-align:right;">
0.543
</td>
<td style="text-align:right;">
0.150
</td>
<td style="text-align:right;">
0.097
</td>
</tr>
<tr>
<td style="text-align:left;">
cycle3
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
0.423
</td>
<td style="text-align:right;">
0.103
</td>
</tr>
<tr>
<td style="text-align:left;">
simX smoke
</td>
<td style="text-align:right;">
0.412
</td>
<td style="text-align:right;">
0.321
</td>
<td style="text-align:right;">
0.132
</td>
</tr>
<tr>
<td style="text-align:left;">
altX alcohol
</td>
<td style="text-align:right;">
-0.069
</td>
<td style="text-align:right;">
0.108
</td>
<td style="text-align:right;">
-0.093
</td>
</tr>
<tr>
<td style="text-align:left;">
egoX alcohol
</td>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
-0.114
</td>
</tr>
<tr>
<td style="text-align:left;">
egoXaltX alcohol
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
0.074
</td>
<td style="text-align:right;">
-0.030
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> tconv.max: 0.185
</td>
</tr>
</tfoot>
</table>
</div>
<p><br> My conclusion is that with RSienatwostep we can properly
estimate a (very simple) network evolution model using the common
ministep assumption. Good job!</p>
</div>
</div>
<div class="section level2">
<h2 id="compare-the-estimates-of-the-different-twostep-models">5. Compare the estimates of the different twostep models<a class="anchor" aria-label="anchor" href="#compare-the-estimates-of-the-different-twostep-models"></a>
</h2>
<p>With different models I mean models with the same statistics but
using different assumptions with respect to the theory of
(inter)action.</p>
<p>I also think this is a nice workflow if we want to test robustness of
ministep model:</p>
<ol style="list-style-type: decimal">
<li>estimate ministep model (with SE, and fit statistics)<br>
</li>
<li>estimate twostep models (phase2 only)
<ol style="list-style-type: lower-alpha">
<li>simultaneity<br>
</li>
<li>strict coordination<br>
</li>
<li>weak coordination<br>
</li>
<li>simstep<br>
</li>
</ol>
</li>
<li>visually check model convergence<br>
</li>
<li>see if twostep models lead to (substantially) different
estimates<br>
</li>
<li>if so, estimate phase3 of these models (and fit statistics) and
compare final models<br>
</li>
<li>Compare GOF</li>
</ol>
<div class="section level3">
<h3 id="estimate-ministep-model">5.1. estimate ministep model<a class="anchor" aria-label="anchor" href="#estimate-ministep-model"></a>
</h3>
<p>We already did this above of course. But hey,..</p>
<div class="section level4">
<h4 id="via-rsiena">5.1.1. via RSiena<a class="anchor" aria-label="anchor" href="#via-rsiena"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Step 1. prepare dataset</span></span>
<span><span class="va">mynet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDependent.html" class="external-link">sienaDependent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">s501</span>, <span class="va">s502</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">alcohol</span> <span class="op">&lt;-</span> <span class="va">s50a</span></span>
<span><span class="va">smoke</span> <span class="op">&lt;-</span> <span class="va">s50s</span></span>
<span><span class="va">smoke</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/coCovar.html" class="external-link">coCovar</a></span><span class="op">(</span><span class="va">smoke</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">alcohol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/coCovar.html" class="external-link">coCovar</a></span><span class="op">(</span><span class="va">alcohol</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDataCreate.html" class="external-link">sienaDataCreate</a></span><span class="op">(</span><span class="va">mynet</span>, <span class="va">smoke</span>, <span class="va">alcohol</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 2. algorithm</span></span>
<span><span class="va">myalgorithm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaAlgorithmCreate.html" class="external-link">sienaAlgorithmCreate</a></span><span class="op">(</span>cond <span class="op">=</span> <span class="cn">FALSE</span>, findiff <span class="op">=</span> <span class="cn">TRUE</span>, projname<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># Step 3. Define the model</span></span>
<span><span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/getEffects.html" class="external-link">getEffects</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span></span>
<span><span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">cycle3</span>, <span class="va">transTrip</span><span class="op">)</span></span>
<span><span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">egoX</span>, <span class="va">altX</span>, <span class="va">egoXaltX</span>, interaction1 <span class="op">=</span> <span class="st">"alcohol"</span><span class="op">)</span></span>
<span><span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">simX</span>, interaction1 <span class="op">=</span> <span class="st">"smoke"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Step 4. Estimate the model. </span></span>
<span><span class="va">ans3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/siena07.html" class="external-link">siena07</a></span><span class="op">(</span><span class="va">myalgorithm</span>, data<span class="op">=</span><span class="va">mydata</span>, effects<span class="op">=</span><span class="va">myeff</span>, batch<span class="op">=</span><span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="via-rsienatwostep">5.1.2. via RsienaTwoStep<a class="anchor" aria-label="anchor" href="#via-rsienatwostep"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Step 1. prepare dataset</span></span>
<span><span class="va">DF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>alcohol <span class="op">=</span> <span class="va">s50a</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, smoke <span class="op">=</span> <span class="va">s50s</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#Step 2. define the model </span></span>
<span><span class="va">STATS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, </span>
<span>              <span class="va">ts_recip</span>, </span>
<span>              <span class="va">ts_transTrip</span>, </span>
<span>              <span class="va">ts_cycle3</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_simX</span>, <span class="st">"smoke"</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_altX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, </span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoXaltX</span>, <span class="st">"alcohol"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Step 3. estimate Ministep model (default)</span></span>
<span><span class="va">ts_ansMS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_estim</a></span><span class="op">(</span>net1 <span class="op">=</span> <span class="va">s501</span>, net2<span class="op">=</span> <span class="va">s502</span>, statistics <span class="op">=</span> <span class="va">STATS</span>, ccovar <span class="op">=</span> <span class="va">DF</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="estimate-twostep-models">5.2. Estimate twostep models<a class="anchor" aria-label="anchor" href="#estimate-twostep-models"></a>
</h3>
<div class="section level4">
<h4 id="phase2">5.2.1. phase2<a class="anchor" aria-label="anchor" href="#phase2"></a>
</h4>
<p>We will use the ans of ’RSiena07()` as our input. We only estimate
phase2. The goal is not so much to come to a perfect estimate but to
check if the estimates are within the CI of the original estimates of
RSiena. Only if this would not be the case, there may be a need to
estimate the model by using different assumptions.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### simultaneity</span></span>
<span><span class="va">ts_ansS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_estim</a></span><span class="op">(</span>ans <span class="op">=</span> <span class="va">ans3</span>, nite <span class="op">=</span> <span class="fl">250</span>, conv <span class="op">=</span> <span class="fl">0.01</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, phase3 <span class="op">=</span> <span class="cn">FALSE</span>, p2step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ts_ansS</span>, <span class="st">"ts_ansS.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### weak coordination</span></span>
<span><span class="va">ts_ansWC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_estim</a></span><span class="op">(</span>ans <span class="op">=</span> <span class="va">ans3</span>, nite <span class="op">=</span> <span class="fl">250</span>, conv <span class="op">=</span> <span class="fl">0.01</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, phase3 <span class="op">=</span> <span class="cn">FALSE</span>, p2step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1 <span class="op">=</span> <span class="fl">2</span>, dist2 <span class="op">=</span> <span class="fl">2</span>, modet1 <span class="op">=</span> <span class="st">"degree"</span>, modet2 <span class="op">=</span> <span class="st">"degree"</span><span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ts_ansWC</span>, <span class="st">"ts_ansWC.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### strict coordination</span></span>
<span><span class="va">ts_ansSC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_estim</a></span><span class="op">(</span>ans <span class="op">=</span> <span class="va">ans3</span>, nite <span class="op">=</span> <span class="fl">250</span>, conv <span class="op">=</span> <span class="fl">0.01</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, phase3 <span class="op">=</span> <span class="cn">FALSE</span>, p2step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1 <span class="op">=</span> <span class="fl">2</span>, modet1 <span class="op">=</span> <span class="st">"degree"</span> <span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ts_ansSC</span>, <span class="st">"ts_ansSC.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### simstep</span></span>
<span><span class="va">ts_ansST</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_estim</a></span><span class="op">(</span>ans <span class="op">=</span> <span class="va">ans3</span>, nite <span class="op">=</span> <span class="fl">250</span>, conv <span class="op">=</span> <span class="fl">0.01</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, phase3 <span class="op">=</span> <span class="cn">FALSE</span>, p2step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ts_ansST</span>, <span class="st">"ts_ansST.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 class="tabset tabset-fade" id="check-convergence-visually-1">5.3. check convergence visually<a class="anchor" aria-label="anchor" href="#check-convergence-visually-1"></a>
</h3>
<p>We see that weak coordination, strict coordination and simstep
stopped after the maximum of 250 iterations. Thus, for these models it
takes (a bit) longer to reach convergence. We also observe more wobbly
lines. But all in all, not too bad?</p>
<div class="section level4">
<h4 id="simultaneity">5.3.1. simultaneity<a class="anchor" aria-label="anchor" href="#simultaneity"></a>
</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_ans</span> <span class="op">&lt;-</span> <span class="va">ts_ansS</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">ts_ans</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">ite</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ans</span><span class="op">)</span></span>
<span><span class="co">#convert data from wide to long format</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span> <span class="va">vars</span>,</span>
<span>                          names_to<span class="op">=</span><span class="st">'statistic'</span>,</span>
<span>                          values_to<span class="op">=</span><span class="st">'estimate'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ite</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-33-1.png" width="700"><br> ### 5.3.2. weak coordination</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_ans</span> <span class="op">&lt;-</span> <span class="va">ts_ansWC</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">ts_ans</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">ite</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ans</span><span class="op">)</span></span>
<span><span class="co">#convert data from wide to long format</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span> <span class="va">vars</span>,</span>
<span>                          names_to<span class="op">=</span><span class="st">'statistic'</span>,</span>
<span>                          values_to<span class="op">=</span><span class="st">'estimate'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ite</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-34-1.png" width="700"><br> ### 5.3.3. strict coordination</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_ans</span> <span class="op">&lt;-</span> <span class="va">ts_ansSC</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">ts_ans</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">ite</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ans</span><span class="op">)</span></span>
<span><span class="co">#convert data from wide to long format</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span> <span class="va">vars</span>,</span>
<span>                          names_to<span class="op">=</span><span class="st">'statistic'</span>,</span>
<span>                          values_to<span class="op">=</span><span class="st">'estimate'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ite</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-35-1.png" width="700"><br> ### 5.3.4. simstep</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_ans</span> <span class="op">&lt;-</span> <span class="va">ts_ansST</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">ts_ans</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">ite</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ans</span><span class="op">)</span></span>
<span><span class="co">#convert data from wide to long format</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">pivot_longer</span><span class="op">(</span>cols<span class="op">=</span> <span class="va">vars</span>,</span>
<span>                          names_to<span class="op">=</span><span class="st">'statistic'</span>,</span>
<span>                          values_to<span class="op">=</span><span class="st">'estimate'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">ite</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">statistic</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-36-1.png" width="700"><br></p>
</div>
</div>
<div class="section level3">
<h3 id="compare-estimates">5.4. Compare estimates<a class="anchor" aria-label="anchor" href="#compare-estimates"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#CI of RSiena</span></span>
<span><span class="va">down</span> <span class="op">&lt;-</span> <span class="va">ans3</span><span class="op">$</span><span class="va">theta</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">$</span><span class="va">covtheta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">up</span> <span class="op">&lt;-</span> <span class="va">ans3</span><span class="op">$</span><span class="va">theta</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">$</span><span class="va">covtheta</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#our statistics</span></span>
<span><span class="va">stats</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">vars</span>, levels <span class="op">=</span> <span class="va">vars</span><span class="op">)</span></span>
<span><span class="co">#final estimates </span></span>
<span><span class="va">b_s</span> <span class="op">&lt;-</span> <span class="va">ts_ansS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ansS</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">b_sc</span> <span class="op">&lt;-</span> <span class="va">ts_ansSC</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ansSC</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">b_wc</span> <span class="op">&lt;-</span> <span class="va">ts_ansWC</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ansWC</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">b_st</span> <span class="op">&lt;-</span> <span class="va">ts_ansST</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ansST</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">#put everything in a dataframe</span></span>
<span><span class="va">my.dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>statistics <span class="op">=</span> <span class="va">stats</span>, estimate<span class="op">=</span><span class="va">ans3</span><span class="op">$</span><span class="va">theta</span>, down<span class="op">=</span><span class="va">down</span>, up<span class="op">=</span><span class="va">up</span>, b_s<span class="op">=</span><span class="va">b_s</span>, b_sc<span class="op">=</span><span class="va">b_sc</span>, b_wc<span class="op">=</span><span class="va">b_wc</span>, b_st<span class="op">=</span><span class="va">b_st</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#use different layers to plot the separate estimates. and include a manual legend. </span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">my.dt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">statistics</span>, y<span class="op">=</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>         </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">down</span>, ymax <span class="op">=</span> <span class="va">up</span>, color<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">stats</span>, y<span class="op">=</span><span class="va">b_s</span>, color<span class="op">=</span><span class="st">"simultaneity"</span> <span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">stats</span>, y<span class="op">=</span><span class="va">b_sc</span> , color<span class="op">=</span><span class="st">"strict coordination"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">stats</span>, y<span class="op">=</span><span class="va">b_wc</span>, color<span class="op">=</span><span class="st">"weak coordination"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">stats</span>, y<span class="op">=</span><span class="va">b_st</span>, color<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name<span class="op">=</span> <span class="st">"Estimation type"</span>, </span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"strict coordination"</span>, <span class="st">"weak coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span>,</span>
<span>                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span><span class="op">=</span> <span class="st">"black"</span>, <span class="st">"simultaneity"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"strict coordination"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"weak coordination"</span> <span class="op">=</span> <span class="st">"green"</span>, <span class="st">"simstep"</span> <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">guide_axis</a></span><span class="op">(</span>n.dodge <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>n.breaks<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-37-1.png" width="700"><br> This figure already tells us that our twostep model more or less
leads to similar estimates. There are some notably exceptions,
however.</p>
<p>Weak coordination: much smaller degree estimate, much larger
reciprocity estimate and larger transTrip estimate. This is not that
strange since that under weak coordination the two alters have to be
connected either at the beginning of the twostep or after the
twostep.</p>
</div>
<div class="section level3">
<h3 id="phase3-for-all-twostep-models">5.5. phase3 for all twostep models<a class="anchor" aria-label="anchor" href="#phase3-for-all-twostep-models"></a>
</h3>
<p>Please note, this can take a long time (more than a week), even with
the relatively low <code>itef3</code> default value of 100 in
<code><a href="../reference/ts_estim.html">ts_phase3()</a></code>.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b_s</span> <span class="op">&lt;-</span> <span class="va">ts_ansS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ansS</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">b_sc</span> <span class="op">&lt;-</span> <span class="va">ts_ansSC</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ansSC</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">b_wc</span> <span class="op">&lt;-</span> <span class="va">ts_ansWC</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ansWC</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">b_st</span> <span class="op">&lt;-</span> <span class="va">ts_ansST</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ts_ansST</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">### simultaneity</span></span>
<span><span class="va">ts_ansSp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_phase3</a></span><span class="op">(</span>mydata <span class="op">=</span> <span class="va">mydata</span>, myeff <span class="op">=</span> <span class="va">myeff</span>, startvalues <span class="op">=</span>  <span class="va">b_s</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span>, p2step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ts_ansSp3</span>, <span class="st">"ts_ansSp3.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### weak coordination</span></span>
<span><span class="va">ts_ansWCp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_phase3</a></span><span class="op">(</span>mydata <span class="op">=</span> <span class="va">mydata</span>, myeff <span class="op">=</span> <span class="va">myeff</span>, startvalues <span class="op">=</span>  <span class="va">b_wc</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span>, p2step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1 <span class="op">=</span> <span class="fl">2</span>, dist2 <span class="op">=</span> <span class="fl">2</span>, modet1 <span class="op">=</span> <span class="st">"degree"</span>, modet2 <span class="op">=</span> <span class="st">"degree"</span><span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ts_ansWCp3</span>, <span class="st">"ts_ansWCp3.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### strict coordination</span></span>
<span><span class="va">ts_ansSCp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_phase3</a></span><span class="op">(</span>mydata <span class="op">=</span> <span class="va">mydata</span>, myeff <span class="op">=</span> <span class="va">myeff</span>, startvalues <span class="op">=</span>  <span class="va">b_sc</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span>, p2step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1 <span class="op">=</span> <span class="fl">2</span>, modet1 <span class="op">=</span> <span class="st">"degree"</span><span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ts_ansSCp3</span>, <span class="st">"ts_ansSCp3.rda"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### simstep</span></span>
<span><span class="va">ts_ansSTp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_estim.html">ts_phase3</a></span><span class="op">(</span>mydata <span class="op">=</span> <span class="va">mydata</span>, myeff <span class="op">=</span> <span class="va">myeff</span>, startvalues <span class="op">=</span>  <span class="va">b_st</span>, parallel <span class="op">=</span> <span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span>, p2step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">fsave</span><span class="op">(</span><span class="va">ts_ansSTp3</span>, <span class="st">"ts_ansSTp3.rda"</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="final-results-1">5.5.1 final results!<a class="anchor" aria-label="anchor" href="#final-results-1"></a>
</h4>
<p>We conclude that all five different theories of interaction lead to
similar conclusions with respect to significance of included
statistics.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estim_MS</span> <span class="op">&lt;-</span> <span class="va">ans3</span><span class="op">$</span><span class="va">theta</span></span>
<span><span class="va">SE_MS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">$</span><span class="va">covtheta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tstat_MS</span> <span class="op">&lt;-</span> <span class="va">ans3</span><span class="op">$</span><span class="va">tconv</span></span>
<span><span class="va">tconv.max_MS</span> <span class="op">&lt;-</span> <span class="va">ans3</span><span class="op">$</span><span class="va">tconv.max</span></span>
<span></span>
<span><span class="va">estim_S</span> <span class="op">&lt;-</span> <span class="va">ts_ansSp3</span><span class="op">$</span><span class="va">estim</span></span>
<span><span class="va">SE_S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ts_ansSp3</span><span class="op">$</span><span class="va">covtheta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tstat_S</span> <span class="op">&lt;-</span> <span class="va">ts_ansSp3</span><span class="op">$</span><span class="va">tstat</span></span>
<span><span class="va">tconv.max_S</span> <span class="op">&lt;-</span> <span class="va">ts_ansSp3</span><span class="op">$</span><span class="va">tconv.max</span></span>
<span></span>
<span><span class="va">estim_WC</span> <span class="op">&lt;-</span> <span class="va">ts_ansWCp3</span><span class="op">$</span><span class="va">estim</span></span>
<span><span class="va">SE_WC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ts_ansWCp3</span><span class="op">$</span><span class="va">covtheta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tstat_WC</span> <span class="op">&lt;-</span> <span class="va">ts_ansWCp3</span><span class="op">$</span><span class="va">tstat</span></span>
<span><span class="va">tconv.max_WC</span> <span class="op">&lt;-</span> <span class="va">ts_ansWCp3</span><span class="op">$</span><span class="va">tconv.max</span></span>
<span></span>
<span><span class="va">estim_SC</span> <span class="op">&lt;-</span> <span class="va">ts_ansSCp3</span><span class="op">$</span><span class="va">estim</span></span>
<span><span class="va">SE_SC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ts_ansSCp3</span><span class="op">$</span><span class="va">covtheta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tstat_SC</span> <span class="op">&lt;-</span> <span class="va">ts_ansSCp3</span><span class="op">$</span><span class="va">tstat</span></span>
<span><span class="va">tconv.max_SC</span> <span class="op">&lt;-</span> <span class="va">ts_ansSCp3</span><span class="op">$</span><span class="va">tconv.max</span></span>
<span></span>
<span><span class="va">estim_ST</span> <span class="op">&lt;-</span> <span class="va">ts_ansSTp3</span><span class="op">$</span><span class="va">estim</span></span>
<span><span class="va">SE_ST</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">ts_ansSTp3</span><span class="op">$</span><span class="va">covtheta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tstat_ST</span> <span class="op">&lt;-</span> <span class="va">ts_ansSTp3</span><span class="op">$</span><span class="va">tstat</span></span>
<span><span class="va">tconv.max_ST</span> <span class="op">&lt;-</span> <span class="va">ts_ansSTp3</span><span class="op">$</span><span class="va">tconv.max</span></span>
<span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estim_MS <span class="op">=</span> <span class="va">estim_MS</span>, SE_MS <span class="op">=</span> <span class="va">SE_MS</span>, tstat_MS <span class="op">=</span> <span class="va">tstat_MS</span>,</span>
<span>                estim_S <span class="op">=</span> <span class="va">estim_S</span>, SE_S <span class="op">=</span> <span class="va">SE_S</span>, tstat_S <span class="op">=</span> <span class="va">tstat_S</span>,</span>
<span>                 estim_WC <span class="op">=</span> <span class="va">estim_WC</span>, SE_WC <span class="op">=</span> <span class="va">SE_WC</span>, tstat_WC <span class="op">=</span> <span class="va">tstat_WC</span>,</span>
<span>                 estim_SC <span class="op">=</span> <span class="va">estim_SC</span>, SE_SC <span class="op">=</span> <span class="va">SE_SC</span>, tstat_SC <span class="op">=</span> <span class="va">tstat_SC</span>,</span>
<span>                 estim_ST <span class="op">=</span> <span class="va">estim_ST</span>, SE_ST <span class="op">=</span> <span class="va">SE_ST</span>, tstat_ST <span class="op">=</span> <span class="va">tstat_ST</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df</span>, digits <span class="op">=</span> <span class="fl">3</span>, <span class="st">"html"</span>,</span>
<span>             col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Estim"</span>, <span class="st">"SE"</span>, <span class="st">"tstat"</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_header_above.html" class="external-link">add_header_above</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"ministep$^a$"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"simultaneity$^b$"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"weak coordination$^c$"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"strict coordination$^d$"</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">"simstep$^e$"</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/add_footnote.html" class="external-link">add_footnote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"tconv.max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tconv.max_MS</span>, <span class="fl">3</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"tconv.max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tconv.max_S</span>, <span class="fl">3</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"tconv.max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tconv.max_WC</span>, <span class="fl">3</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"tconv.max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tconv.max_SC</span>, <span class="fl">3</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"tconv.max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tconv.max_ST</span>, <span class="fl">3</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">" "</span><span class="op">)</span></span>
<span>                             <span class="op">)</span>, notation<span class="op">=</span><span class="st">"alphabet"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html" class="external-link">scroll_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span>, height <span class="op">=</span> <span class="st">"500px"</span><span class="op">)</span> </span>
<span>        </span>
<span><span class="va">results</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:500px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-hover" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;position: sticky; top:0; background-color: #FFFFFF;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ministep<span class="math inline">\(^a\)</span>
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
simultaneity<span class="math inline">\(^b\)</span>
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
weak coordination<span class="math inline">\(^c\)</span>
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
strict coordination<span class="math inline">\(^d\)</span>
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; position: sticky; top:0; background-color: #FFFFFF;" colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
simstep<span class="math inline">\(^e\)</span>
</div>
</th>
</tr>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Estim
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
SE
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tstat
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Estim
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
SE
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tstat
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Estim
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
SE
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tstat
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Estim
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
SE
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tstat
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
Estim
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
SE
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tstat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
rate
</td>
<td style="text-align:right;">
6.230
</td>
<td style="text-align:right;">
1.007
</td>
<td style="text-align:right;">
0.045
</td>
<td style="text-align:right;">
6.002
</td>
<td style="text-align:right;">
0.923
</td>
<td style="text-align:right;">
-0.062
</td>
<td style="text-align:right;">
6.852
</td>
<td style="text-align:right;">
1.284
</td>
<td style="text-align:right;">
-0.003
</td>
<td style="text-align:right;">
5.805
</td>
<td style="text-align:right;">
0.941
</td>
<td style="text-align:right;">
-0.339
</td>
<td style="text-align:right;">
5.560
</td>
<td style="text-align:right;">
0.875
</td>
<td style="text-align:right;">
-0.126
</td>
</tr>
<tr>
<td style="text-align:left;">
degree
</td>
<td style="text-align:right;">
-2.521
</td>
<td style="text-align:right;">
0.143
</td>
<td style="text-align:right;">
0.017
</td>
<td style="text-align:right;">
-2.523
</td>
<td style="text-align:right;">
0.124
</td>
<td style="text-align:right;">
-0.092
</td>
<td style="text-align:right;">
-4.560
</td>
<td style="text-align:right;">
0.725
</td>
<td style="text-align:right;">
0.551
</td>
<td style="text-align:right;">
-2.266
</td>
<td style="text-align:right;">
0.124
</td>
<td style="text-align:right;">
-0.717
</td>
<td style="text-align:right;">
-3.058
</td>
<td style="text-align:right;">
0.215
</td>
<td style="text-align:right;">
-0.235
</td>
</tr>
<tr>
<td style="text-align:left;">
recip
</td>
<td style="text-align:right;">
2.046
</td>
<td style="text-align:right;">
0.282
</td>
<td style="text-align:right;">
-0.004
</td>
<td style="text-align:right;">
2.014
</td>
<td style="text-align:right;">
0.252
</td>
<td style="text-align:right;">
-0.097
</td>
<td style="text-align:right;">
3.205
</td>
<td style="text-align:right;">
0.567
</td>
<td style="text-align:right;">
0.466
</td>
<td style="text-align:right;">
1.666
</td>
<td style="text-align:right;">
0.265
</td>
<td style="text-align:right;">
-0.717
</td>
<td style="text-align:right;">
2.575
</td>
<td style="text-align:right;">
0.395
</td>
<td style="text-align:right;">
-0.233
</td>
</tr>
<tr>
<td style="text-align:left;">
transTrip
</td>
<td style="text-align:right;">
0.543
</td>
<td style="text-align:right;">
0.173
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
0.525
</td>
<td style="text-align:right;">
0.136
</td>
<td style="text-align:right;">
-0.125
</td>
<td style="text-align:right;">
0.963
</td>
<td style="text-align:right;">
0.285
</td>
<td style="text-align:right;">
0.354
</td>
<td style="text-align:right;">
0.369
</td>
<td style="text-align:right;">
0.116
</td>
<td style="text-align:right;">
-1.015
</td>
<td style="text-align:right;">
0.659
</td>
<td style="text-align:right;">
0.135
</td>
<td style="text-align:right;">
-0.256
</td>
</tr>
<tr>
<td style="text-align:left;">
cycle3
</td>
<td style="text-align:right;">
0.058
</td>
<td style="text-align:right;">
0.316
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
0.297
</td>
<td style="text-align:right;">
-0.114
</td>
<td style="text-align:right;">
0.285
</td>
<td style="text-align:right;">
0.598
</td>
<td style="text-align:right;">
0.373
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.256
</td>
<td style="text-align:right;">
-0.986
</td>
<td style="text-align:right;">
-0.027
</td>
<td style="text-align:right;">
0.439
</td>
<td style="text-align:right;">
-0.247
</td>
</tr>
<tr>
<td style="text-align:left;">
simX smoke
</td>
<td style="text-align:right;">
0.412
</td>
<td style="text-align:right;">
0.281
</td>
<td style="text-align:right;">
-0.014
</td>
<td style="text-align:right;">
0.387
</td>
<td style="text-align:right;">
0.365
</td>
<td style="text-align:right;">
-0.113
</td>
<td style="text-align:right;">
0.655
</td>
<td style="text-align:right;">
0.477
</td>
<td style="text-align:right;">
0.128
</td>
<td style="text-align:right;">
0.375
</td>
<td style="text-align:right;">
0.277
</td>
<td style="text-align:right;">
-0.362
</td>
<td style="text-align:right;">
0.544
</td>
<td style="text-align:right;">
0.395
</td>
<td style="text-align:right;">
-0.117
</td>
</tr>
<tr>
<td style="text-align:left;">
altX alcohol
</td>
<td style="text-align:right;">
-0.069
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
0.043
</td>
<td style="text-align:right;">
-0.069
</td>
<td style="text-align:right;">
0.105
</td>
<td style="text-align:right;">
0.153
</td>
<td style="text-align:right;">
-0.100
</td>
<td style="text-align:right;">
0.134
</td>
<td style="text-align:right;">
0.149
</td>
<td style="text-align:right;">
-0.070
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
0.041
</td>
<td style="text-align:right;">
-0.086
</td>
<td style="text-align:right;">
0.121
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
<tr>
<td style="text-align:left;">
egoX alcohol
</td>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
0.093
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
0.044
</td>
<td style="text-align:right;">
0.108
</td>
<td style="text-align:right;">
0.131
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
0.141
</td>
<td style="text-align:right;">
0.108
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
0.079
</td>
<td style="text-align:right;">
0.021
</td>
<td style="text-align:right;">
0.074
</td>
<td style="text-align:right;">
0.128
</td>
<td style="text-align:right;">
0.026
</td>
</tr>
<tr>
<td style="text-align:left;">
egoXaltX alcohol
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
0.075
</td>
<td style="text-align:right;">
-0.007
</td>
<td style="text-align:right;">
0.098
</td>
<td style="text-align:right;">
0.077
</td>
<td style="text-align:right;">
-0.118
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
0.112
</td>
<td style="text-align:right;">
0.341
</td>
<td style="text-align:right;">
0.090
</td>
<td style="text-align:right;">
0.064
</td>
<td style="text-align:right;">
-0.222
</td>
<td style="text-align:right;">
0.134
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
-0.071
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>a</sup> tconv.max: 0.098
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>b</sup> tconv.max: 0.251
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>c</sup> tconv.max: 0.746
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>d</sup> tconv.max: 1.072
</td>
</tr>
<tr>
<td style="padding: 0; border:0;" colspan="100%">
<sup>e</sup> tconv.max: 0.282
</td>
</tr>
</tfoot>
</table>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#kableExtra::save_kable(results, "./data/processed/results.html")</span></span></code></pre></div>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 class="tabset tabset-fade" id="gof">5.6. GOF<a class="anchor" aria-label="anchor" href="#gof"></a>
</h3>
<p>Overal conclusion:</p>
<ul>
<li>for this data and this model specification (i.e. included
statistics)
<ul>
<li>ministep and simultaneity are more or less identical<br>
</li>
<li>differences between the different theories of interaction are
small<br>
</li>
<li>simstep seems to be the best overal performance</li>
</ul>
</li>
</ul>
<div class="section level4">
<h4 id="gof---degree-distribution">5.6.1 GOF - degree distribution<a class="anchor" aria-label="anchor" href="#gof---degree-distribution"></a>
</h4>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_tsMS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_degreecount</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ans1c_phase3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span> </span>
<span><span class="va">df_tsS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_degreecount</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"simultaneity"</span><span class="op">)</span> </span>
<span><span class="va">df_tsWC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_degreecount</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansWCp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"weak coordination"</span><span class="op">)</span> </span>
<span><span class="va">df_tsSC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_degreecount</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSCp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"strict coordination"</span><span class="op">)</span> </span>
<span><span class="va">df_tsST</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_degreecount</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSTp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#targets</span></span>
<span><span class="va">df_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_degreecount</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">s502</span><span class="op">)</span>, simtype<span class="op">=</span><span class="st">"target"</span><span class="op">)</span></span>
<span><span class="va">df_target</span> <span class="op">&lt;-</span> <span class="va">df_target</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_target</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"target"</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_tsMS</span>, <span class="va">df_tsS</span>, <span class="va">df_tsWC</span>, <span class="va">df_tsSC</span>, <span class="va">df_tsST</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">df</span>, <span class="va">df_target</span><span class="op">)</span></span>
<span><span class="co">#focus in degree until 6</span></span>
<span><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"deg1"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"deg2"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"deg3"</span><span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"deg4"</span><span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"deg5"</span><span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"deg6"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">target</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color<span class="op">=</span><span class="st">"black"</span>, shape<span class="op">=</span><span class="fl">10</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>               width<span class="op">=</span><span class="fl">.1</span>,</span>
<span>               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"degree"</span>, y <span class="op">=</span> <span class="st">"degree count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span> </span>
<span>  </span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-42-1.png" width="700"><br> Interesting!!</p>
<p>Some tentative conclusions:</p>
<ul>
<li>no difference between simultaneity and ministep<br>
</li>
<li>weak coordination is best for degree 1 and degree 4. At higher
degrees (5 and 6) is strict coordination the best.</li>
<li>simstep is either just as good as ministep or outperforms
ministep</li>
</ul>
</div>
<div class="section level4">
<h4 id="gof---dyad-census">5.6.2. GOF - dyad census<a class="anchor" aria-label="anchor" href="#gof---dyad-census"></a>
</h4>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_tsMS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ans1c_phase3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span> </span>
<span><span class="va">df_tsS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"simultaneity"</span><span class="op">)</span> </span>
<span><span class="va">df_tsWC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansWCp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"weak coordination"</span><span class="op">)</span> </span>
<span><span class="va">df_tsSC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSCp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"strict coordination"</span><span class="op">)</span> </span>
<span><span class="va">df_tsST</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSTp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#targets</span></span>
<span><span class="va">df_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">s502</span><span class="op">)</span>, simtype<span class="op">=</span><span class="st">"target"</span><span class="op">)</span></span>
<span><span class="va">df_target</span> <span class="op">&lt;-</span> <span class="va">df_target</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_target</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"target"</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_tsMS</span>, <span class="va">df_tsS</span>, <span class="va">df_tsWC</span>, <span class="va">df_tsSC</span>, <span class="va">df_tsST</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">df</span>, <span class="va">df_target</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"asym"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"mut"</span> ,<span class="op">]</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>               width<span class="op">=</span><span class="fl">.1</span>,</span>
<span>               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">target</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color<span class="op">=</span><span class="st">"black"</span>, shape<span class="op">=</span><span class="fl">10</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"dyad type"</span>, y <span class="op">=</span> <span class="st">"dyad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-44-1.png" width="700"><br></p>
<p>Conclusion:</p>
<ul>
<li>strict coordination seems to be the winner.<br>
</li>
<li>simstep is outperforming ministep.</li>
</ul>
</div>
<div class="section level4">
<h4 id="gof---triad-census">5.6.3. GOF - triad census<a class="anchor" aria-label="anchor" href="#gof---triad-census"></a>
</h4>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_tsMS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ans1c_phase3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span> </span>
<span><span class="va">df_tsS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"simultaneity"</span><span class="op">)</span> </span>
<span><span class="va">df_tsWC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansWCp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"weak coordination"</span><span class="op">)</span> </span>
<span><span class="va">df_tsSC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSCp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"strict coordination"</span><span class="op">)</span> </span>
<span><span class="va">df_tsST</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSTp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#targets</span></span>
<span><span class="va">df_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">s502</span><span class="op">)</span>, simtype<span class="op">=</span><span class="st">"target"</span><span class="op">)</span></span>
<span><span class="va">df_target</span> <span class="op">&lt;-</span> <span class="va">df_target</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_target</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"target"</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_tsMS</span>, <span class="va">df_tsS</span>, <span class="va">df_tsWC</span>, <span class="va">df_tsSC</span>, <span class="va">df_tsST</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">df</span>, <span class="va">df_target</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(x)`</span></span>
<span></span>
<span><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"021D"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"021U"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"021C"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>               width<span class="op">=</span><span class="fl">.1</span>,</span>
<span>               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">target</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color<span class="op">=</span><span class="st">"black"</span>, shape<span class="op">=</span><span class="fl">10</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"triad type"</span>, y <span class="op">=</span> <span class="st">"triad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-46-1.png" width="700"><br> Conclusion:</p>
<ul>
<li>strict coordination seems to be the winner.<br>
</li>
<li>simstep is not outperforming ministep for triad configurations.</li>
</ul>
</div>
<div class="section level4">
<h4 id="gof---smoke-segregation">5.6.4. GOF - smoke segregation<a class="anchor" aria-label="anchor" href="#gof---smoke-segregation"></a>
</h4>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_tsMS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ans1c_phase3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"ministep"</span>, cov<span class="op">=</span><span class="va">DF</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> </span>
<span><span class="va">df_tsS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"simultaneity"</span>, cov<span class="op">=</span><span class="va">DF</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> </span>
<span><span class="va">df_tsWC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansWCp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"weak coordination"</span>, cov<span class="op">=</span><span class="va">DF</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> </span>
<span><span class="va">df_tsSC</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSCp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"strict coordination"</span>, cov<span class="op">=</span><span class="va">DF</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> </span>
<span><span class="va">df_tsST</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">ts_ansSTp3</span><span class="op">$</span><span class="va">simnets</span>, simtype<span class="op">=</span><span class="st">"simstep"</span>, cov<span class="op">=</span><span class="va">DF</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#targets</span></span>
<span><span class="va">df_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">s502</span><span class="op">)</span>, simtype<span class="op">=</span><span class="st">"target"</span>, cov<span class="op">=</span><span class="va">DF</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_target</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"target"</span></span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_tsMS</span>, <span class="va">df_tsS</span>, <span class="va">df_tsWC</span>, <span class="va">df_tsSC</span>, <span class="va">df_tsST</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span> </span>
<span><span class="va">df</span><span class="op">$</span><span class="va">target</span> <span class="op">&lt;-</span> <span class="va">df_target</span><span class="op">$</span><span class="va">target</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="va">MoranI</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"errorbar"</span>,</span>
<span>               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>               width<span class="op">=</span><span class="fl">.1</span>,</span>
<span>               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="va">target</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep"</span>, <span class="st">"simultaneity"</span>, <span class="st">"weak coordination"</span>, <span class="st">"strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, fun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>               geom <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>               color<span class="op">=</span><span class="st">"black"</span>, shape<span class="op">=</span><span class="fl">10</span>, position<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"simulation type"</span>, y <span class="op">=</span> <span class="st">"smoke segregation (MoranI)"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">guide_axis</a></span><span class="op">(</span>n.dodge <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-48-1.png" width="700"><br> Conclusion:</p>
<ul>
<li>weak and strict coordination are doing worst</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">6. Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>RsienaTwoStep offers a workflow for assessing the extent to which the
ministep assumption is crucial. By crucial I mean that parameter
estimates and model fit depend on the chosen ‘micro theory of
interaction’.<br>
In the above example, the assumption is not crucial. All theories of
interaction lead to similar conclusions with respect to the significance
of the included statistics and the GOF of the ministep and twostep
models are very similar. Perhaps the simstep models has the best
GOF.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jochem Tolsma.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
