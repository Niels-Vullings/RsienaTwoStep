<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="RsienaTwoStep">
<title>RSienaWorkFlow • RsienaTwoStep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RSienaWorkFlow">
<meta property="og:description" content="RsienaTwoStep">
<meta property="og:image" content="https://jochemtolsma.github.io/RsienaTwoStep/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RsienaTwoStep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Introduction_RsienaTwoStep.html">Introduction_RsienaTwoStep</a>
    <a class="dropdown-item" href="../articles/MinistepToTwoStep.html">MinistepToTwostep</a>
    <a class="dropdown-item" href="../articles/RsienaWorkflow.html">RSienaWorkFlow</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JochemTolsma/RsienaTwoStep/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>RSienaWorkFlow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JochemTolsma/RsienaTwoStep/blob/HEAD/vignettes/articles/RsienaWorkflow.Rmd" class="external-link"><code>vignettes/articles/RsienaWorkflow.Rmd</code></a></small>
      <div class="d-none name"><code>RsienaWorkflow.Rmd</code></div>
    </div>

    
    
<style type="text/css">
.test {
  max-height: 300px;
  overflow-y: auto;
  overflow-x: auto;
  margin: 10px;
}

.test2 {
  max-height: 300px;
  overflow-y: auto;
  overflow-x: auto;
  margin: 10px;
  background-color: white;
  color: rgb(201, 76, 76);
}


h1, .h1, h2, .h2, h3, .h3 {
  margin-top: 24px;
}





.button1 {
  background-color: grey; /* Red */ 
  border: 2px solid black;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
  /* border-radius: 12px; */
  width: 100%;
}

.button1:hover {
  box-shadow: 0 12px 16px 0 rgba(0,0,0,0.24), 0 17px 50px 0 rgba(0,0,0,0.19);
}

.button1:active {
  border: 2px solid red;
}

pre {
  max-height: 300px;
  overflow-y: auto;
  overflow-x: auto;
  margin: 0px;
}

.watch-out {
  background-color: lightpink;
  border: 3px solid red;
  font-weight: bold;
}

.large {
  max-height: 1100px;
  overflow-y: auto;
  overflow-x: auto;
  width: 1100px;
}


body{ /* Normal  */
    font-size: 14px;
}

h1 { /* Header 1 */
    font-size: 20px;
  font-weight: bold;
}

h2 { /* Header 2 */
    font-size: 18px;
  color: DarkBlue;
}

h3 { /* Header 3 */
    font-size: 16px;
  color: DarkBlue;
}

blockquote {
  padding: 10px 20px;
  margin: 0 0 20px;
  font-size: 14px;
  border-left: 6px solid #eee;
  background-color:lightcyan
}

caption {
  font-size: 14px;
  color: black;
  font-weight: bold
}

pre.numberSource a.sourceLine {
  left: -1em;
}

</style>
<div class="section level2">
<h2 id="getting-started">1. Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="section level3">
<h3 id="basic-functions">1.1. Basic functions<a class="anchor" aria-label="anchor" href="#basic-functions"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fsave</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">file</span>, <span class="va">location</span> <span class="op">=</span> <span class="st">"./data/processed/"</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span>
    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span><span class="op">)</span>
        <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span>
    <span class="va">datename</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"[:-]"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">8</span><span class="op">)</span>
    <span class="va">totalname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">location</span>, <span class="va">datename</span>, <span class="va">file</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SAVED: "</span>, <span class="va">totalname</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">x</span>, file <span class="op">=</span> <span class="va">totalname</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">fpackage.check</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">packages</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">packages</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">x</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
            <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="va">x</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
            <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">x</span>, character.only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">colorize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">color</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"&lt;span style='color: %s;'&gt;%s&lt;/span&gt;"</span>, <span class="va">color</span>, <span class="va">x</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="packages">1.2. Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">packages</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RsienaTwoStep"</span>, <span class="st">"RSiena"</span>, <span class="st">"doParallel"</span>, <span class="st">"compiler"</span>, <span class="st">"ggplot2"</span><span class="op">)</span>

<span class="fu">fpackage.check</span><span class="op">(</span><span class="va">packages</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: RsienaTwoStep</span>
<span class="co">#&gt; Loading required package: foreach</span>
<span class="co">#&gt; Loading required package: RSiena</span>
<span class="co">#&gt; Warning: package 'RSiena' was built under R version 4.2.3</span>
<span class="co">#&gt; Loading required package: doParallel</span>
<span class="co">#&gt; Loading required package: iterators</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="co">#&gt; Loading required package: compiler</span>
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.2.2</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; NULL</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="auxiliary-functions-for-rsienasienagof">1.3. Auxiliary functions for <code>RSiena::SienaGOF()</code><a class="anchor" aria-label="anchor" href="#auxiliary-functions-for-rsienasienagof"></a>
</h3>
<p>Please see: <code>RSiena::SienaGOF()</code>.</p>
<p>I want to be able to have a dyadcensus/triadcensus in the GOF of
Rsiena. Thus, these functions have been added to
<code>RsienaTwoStep</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">DyadCensus.sna</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">data</span>, <span class="va">sims</span>, <span class="va">period</span>, <span class="va">groupName</span>, <span class="va">varName</span>, <span class="va">levls</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">unloadNamespace</a></span><span class="op">(</span><span class="st">"igraph"</span><span class="op">)</span> <span class="co"># to avoid package clashes</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://statnet.org/" class="external-link">network</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://statnet.org" class="external-link">sna</a></span><span class="op">)</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">networkExtraction</span><span class="op">(</span><span class="va">i</span>, <span class="va">data</span>, <span class="va">sims</span>, <span class="va">period</span>, <span class="va">groupName</span>, <span class="va">varName</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/network/man/network.edgecount.html" class="external-link">network.edgecount</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sna/man/symmetrize.html" class="external-link">symmetrize</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>
  <span class="co"># because else triad.census(x) will lead to an error</span>
  <span class="va">tc</span> <span class="op">&lt;-</span> <span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/dyad.census.html" class="external-link">dyad.census</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="va">levls</span><span class="op">]</span>
  <span class="co"># names are transferred automatically</span>
  <span class="va">tc</span>
<span class="op">}</span>

<span class="va">DyadCensus.sna</span> <span class="op">&lt;-</span> <span class="fu">cmpfun</span><span class="op">(</span><span class="va">DyadCensus.sna</span><span class="op">)</span>


<span class="va">TriadCensus.sna</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">data</span>, <span class="va">sims</span>, <span class="va">period</span>, <span class="va">groupName</span>, <span class="va">varName</span>, <span class="va">levls</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">unloadNamespace</a></span><span class="op">(</span><span class="st">"igraph"</span><span class="op">)</span> <span class="co"># to avoid package clashes</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://statnet.org/" class="external-link">network</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://statnet.org" class="external-link">sna</a></span><span class="op">)</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">networkExtraction</span><span class="op">(</span><span class="va">i</span>, <span class="va">data</span>, <span class="va">sims</span>, <span class="va">period</span>, <span class="va">groupName</span>, <span class="va">varName</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/network/man/network.edgecount.html" class="external-link">network.edgecount</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sna/man/symmetrize.html" class="external-link">symmetrize</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>
  
  <span class="co"># because else triad.census(x) will lead to an error</span>
  <span class="va">tc</span> <span class="op">&lt;-</span> <span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/triad.census.html" class="external-link">triad.census</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="va">levls</span><span class="op">]</span>
  <span class="co"># names are transferred automatically</span>
  <span class="va">tc</span>
<span class="op">}</span>

<span class="va">TriadCensus.sna</span> <span class="op">&lt;-</span> <span class="fu">cmpfun</span><span class="op">(</span><span class="va">TriadCensus.sna</span><span class="op">)</span>


<span class="va">Nacf.sna</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span>, <span class="va">data</span>, <span class="va">sims</span>, <span class="va">period</span>, <span class="va">groupName</span>, <span class="va">varName</span>, <span class="va">cov</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">unloadNamespace</a></span><span class="op">(</span><span class="st">"igraph"</span><span class="op">)</span> <span class="co"># to avoid package clashes</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://statnet.org/" class="external-link">network</a></span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="http://statnet.org" class="external-link">sna</a></span><span class="op">)</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">networkExtraction</span><span class="op">(</span><span class="va">i</span>, <span class="va">data</span>, <span class="va">sims</span>, <span class="va">period</span>, <span class="va">groupName</span>, <span class="va">varName</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/network/man/network.edgecount.html" class="external-link">network.edgecount</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sna/man/symmetrize.html" class="external-link">symmetrize</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>
  <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sna/man/sna-coercion.html" class="external-link">as.sociomatrix.sna</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="va">snaM1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">sna</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/sna/man/nacf.html" class="external-link">nacf</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cov</span>, type <span class="op">=</span> <span class="st">"moran"</span>, neighborhood.type <span class="op">=</span> <span class="st">"out"</span>, demean <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="co">#because I need dimension in order to set names</span>
  <span class="va">snaM1</span>
<span class="op">}</span>

<span class="va">Nacf.sna</span> <span class="op">&lt;-</span> <span class="fu">cmpfun</span><span class="op">(</span><span class="va">Nacf.sna</span><span class="op">)</span></code></pre></div>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-cluster">2. Setting up cluster<a class="anchor" aria-label="anchor" href="#setting-up-cluster"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#stopCluster(my.cluster) </span>
<span class="va">n.cores</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>  <span class="co">#save one core for other work</span>
<span class="co"># create the cluster</span>
<span class="va">my.cluster</span> <span class="op">&lt;-</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="va">n.cores</span>, type <span class="op">=</span> <span class="st">"PSOCK"</span><span class="op">)</span>
<span class="co"># register it to be used by %dopar%</span>
<span class="fu">doParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span>cl <span class="op">=</span> <span class="va">my.cluster</span><span class="op">)</span>

<span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">my.cluster</span>, <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://statnet.org/" class="external-link">"network"</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">my.cluster</span>, <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"RSiena"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">clusterEvalQ</a></span><span class="op">(</span><span class="va">my.cluster</span>, <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://statnet.org" class="external-link">"sna"</a></span><span class="op">)</span><span class="op">)</span></code></pre></div>
<hr>
</div>
<div class="section level2">
<h2 id="model-1-degree-and-reciprocity">3. Model 1: Degree and reciprocity<a class="anchor" aria-label="anchor" href="#model-1-degree-and-reciprocity"></a>
</h2>
<div class="section level3">
<h3 id="running-siena07">3.1. Running <code>siena07()</code><a class="anchor" aria-label="anchor" href="#running-siena07"></a>
</h3>
<p>Make sure that in <code><a href="https://rdrr.io/pkg/RSiena/man/sienaAlgorithmCreate.html" class="external-link">sienaAlgorithmCreate()</a></code>: the argument
<code>cond</code> is set to <code>FALSE</code> so the rate parameter is
estimated and can be accessed via <code>summary(ans)$theta</code>.<br>
Make sure that in <code>siena07</code> the <code>returnDeps</code>
argument is set to <code>TRUE</code> so the simulated networks are
saved. If you want to be able to replicate the simulated networks by
<code>siena07</code> it is best to estimate <code>siena07</code> for one
period (two waves) only.</p>
<p>We only include the following statistics:<br>
- degree<br>
- reciprocity</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mynet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDependent.html" class="external-link">sienaDependent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">s501</span>, <span class="va">s502</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDataCreate.html" class="external-link">sienaDataCreate</a></span><span class="op">(</span><span class="va">mynet</span><span class="op">)</span>
<span class="va">myalgorithm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaAlgorithmCreate.html" class="external-link">sienaAlgorithmCreate</a></span><span class="op">(</span>seed<span class="op">=</span><span class="fl">1293</span>, cond<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">#toggle set conditional to retrieve the rate parameter in theta!</span>
<span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/getEffects.html" class="external-link">getEffects</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span>
<span class="va">ans1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/siena07.html" class="external-link">siena07</a></span><span class="op">(</span><span class="va">myalgorithm</span>, data<span class="op">=</span><span class="va">mydata</span>, effects<span class="op">=</span><span class="va">myeff</span>, batch<span class="op">=</span><span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>let’s have a look</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ans1</span>
<span class="co">#&gt; Estimates, standard errors and convergence t-ratios</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                      Estimate   Standard   Convergence </span>
<span class="co">#&gt;                                                   Error      t-ratio   </span>
<span class="co">#&gt;   1. rate basic rate parameter mynet  5.4779  ( 0.7823   )   -0.1504   </span>
<span class="co">#&gt;   2. eval outdegree (density)        -2.2272  ( 0.1282   )   -0.0071   </span>
<span class="co">#&gt;   3. eval reciprocity                 2.4316  ( 0.2463   )    0.0007   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Overall maximum convergence ratio:    0.1563 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Total of 2439 iteration steps.</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate-networks-via-rsienatwostep">3.2. Simulate networks via <code>RsienaTwoStep</code><a class="anchor" aria-label="anchor" href="#simulate-networks-via-rsienatwostep"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Ministep</span>
<span class="va">sims1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Twostep: Simultaneity </span>
<span class="va">sims2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Twostep: Weak coordination </span>
<span class="va">sims3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1<span class="op">=</span><span class="fl">2</span>, dist2<span class="op">=</span><span class="fl">2</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co">### Twostep: Strict coordination </span>
<span class="va">sims4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1<span class="op">=</span><span class="fl">2</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co">### Simstep </span>
<span class="va">sims5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans1</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="counting-dyads">3.3. Counting dyads<a class="anchor" aria-label="anchor" href="#counting-dyads"></a>
</h3>
<div class="section level4">
<h4 id="rsiena">3.3.1. RSiena<a class="anchor" aria-label="anchor" href="#rsiena"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gofi <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans1,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                 DyadCensus.sna, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">join =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">varName =</span> <span class="st">"mynet"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Calculating auxiliary statistics for period  1 .</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &gt; Completed  100  calculations</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">200</span>  calculations</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">300</span>  calculations</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">400</span>  calculations</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">500</span>  calculations</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">600</span>  calculations</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">700</span>  calculations</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">800</span>  calculations</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">900</span>  calculations</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">1000</span>  calculations</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">1000</span>  calculations</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gofi</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Simulations</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dfrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mut"</span>, <span class="st">"Asym"</span>, <span class="st">"Null"</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfrs</span>, <span class="va">dfrs</span>, <span class="va">dfrs</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mut"</span>, <span class="st">"asym"</span>, <span class="st">"null"</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dfrs</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"mut"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Mut</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"mut"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"asym"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Asym</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"asym"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"null"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Null</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"null"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"rsiena"</span>
<span class="va">dfrs_siena</span> <span class="op">&lt;-</span> <span class="va">df</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"dfrs"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rsienatwostep">3.3.2. RsienaTwoStep<a class="anchor" aria-label="anchor" href="#rsienatwostep"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ts1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1</span>, simtype<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span> 
<span class="va">df_ts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims2</span>, simtype<span class="op">=</span><span class="st">"twostep-simultaneity"</span><span class="op">)</span>
<span class="va">df_ts3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims3</span>, simtype<span class="op">=</span><span class="st">"twostep-weak coordination"</span><span class="op">)</span> 
<span class="va">df_ts4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims4</span>, simtype<span class="op">=</span><span class="st">"twostep-strict coordination"</span><span class="op">)</span>
<span class="va">df_ts5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims5</span>, simtype<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="plotting-dyad_census">3.4. Plotting dyad_census<a class="anchor" aria-label="anchor" href="#plotting-dyad_census"></a>
</h3>
<div class="section level4">
<h4 id="all-three-dyad-types">3.4.1. All three dyad types<a class="anchor" aria-label="anchor" href="#all-three-dyad-types"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfrs_siena</span>, <span class="va">df_ts1</span>, <span class="va">df_ts2</span>, <span class="va">df_ts3</span>, <span class="va">df_ts4</span>, <span class="va">df_ts5</span><span class="op">)</span>



<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"dyad type"</span>, y <span class="op">=</span> <span class="st">"dyad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="plotting-dyad-census-selection">3.4.2. Plotting dyad census selection<a class="anchor" aria-label="anchor" href="#plotting-dyad-census-selection"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">!=</span><span class="st">"null"</span>, <span class="op">]</span>

<span class="va">dodge</span> <span class="op">&lt;-</span> <span class="fu">position_dodge</span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"dyad type"</span>, y <span class="op">=</span> <span class="st">"dyad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="model-2-degree-reciprocity-and-3cycle">4. Model 2: Degree, reciprocity and 3cycle<a class="anchor" aria-label="anchor" href="#model-2-degree-reciprocity-and-3cycle"></a>
</h2>
<div class="section level3">
<h3 id="running-siena07-1">4.1. Running <code>siena07()</code><a class="anchor" aria-label="anchor" href="#running-siena07-1"></a>
</h3>
<p>We only include the following statistics:<br>
- degree<br>
- reciprocity<br>
- cycle3</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mynet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDependent.html" class="external-link">sienaDependent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">s501</span>, <span class="va">s502</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDataCreate.html" class="external-link">sienaDataCreate</a></span><span class="op">(</span><span class="va">mynet</span><span class="op">)</span>
<span class="va">myalgorithm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaAlgorithmCreate.html" class="external-link">sienaAlgorithmCreate</a></span><span class="op">(</span>seed<span class="op">=</span><span class="fl">1293</span>, cond<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">#toggle set conditional to retrieve the rate parameter in theta!</span>
<span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/getEffects.html" class="external-link">getEffects</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span>
<span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">cycle3</span><span class="op">)</span>
<span class="va">ans2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/siena07.html" class="external-link">siena07</a></span><span class="op">(</span><span class="va">myalgorithm</span>, data<span class="op">=</span><span class="va">mydata</span>, effects<span class="op">=</span><span class="va">myeff</span>, batch<span class="op">=</span><span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">fsave</span><span class="op">(</span><span class="va">ans2</span>, file<span class="op">=</span><span class="st">"ans2.Rdata"</span><span class="op">)</span></code></pre></div>
<p>let’s have a look</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ans2</span>
<span class="co">#&gt; Estimates, standard errors and convergence t-ratios</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                      Estimate   Standard   Convergence </span>
<span class="co">#&gt;                                                   Error      t-ratio   </span>
<span class="co">#&gt;   1. rate basic rate parameter mynet  6.1899  ( 0.8994   )   -0.0788   </span>
<span class="co">#&gt;   2. eval outdegree (density)        -2.5006  ( 0.1536   )   -0.0289   </span>
<span class="co">#&gt;   3. eval reciprocity                 2.2268  ( 0.2401   )   -0.0614   </span>
<span class="co">#&gt;   4. eval 3-cycles                    1.0337  ( 0.2013   )   -0.0358   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Overall maximum convergence ratio:    0.1307 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Total of 2131 iteration steps.</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate-networks-via-rsienatwostep-1">4.2. Simulate networks via <code>RsienaTwoStep</code><a class="anchor" aria-label="anchor" href="#simulate-networks-via-rsienatwostep-1"></a>
</h3>
<p><span style="color: red;">These simulations took two days to complete
on a simple HP Elitebook 855 G7</span></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#ministep</span>
<span class="va">sims1m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_cycle3</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims1m2</span>, file<span class="op">=</span><span class="st">"sims1m2.Rdata"</span><span class="op">)</span>

<span class="co">#simultaneity</span>
<span class="va">sims2m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_cycle3</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims2m2</span>, file<span class="op">=</span><span class="st">"sims2m2.Rdata"</span><span class="op">)</span>

<span class="co">#weak coordination</span>
<span class="va">sims3m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_cycle3</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1<span class="op">=</span><span class="fl">2</span>, dist2<span class="op">=</span><span class="fl">2</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims3m2</span>, file<span class="op">=</span><span class="st">"sims3m2.Rdata"</span><span class="op">)</span>

<span class="co">#strict coordination</span>
<span class="va">sims4m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_cycle3</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1<span class="op">=</span><span class="fl">2</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims4m2</span>, file<span class="op">=</span><span class="st">"sims4m2.Rdata"</span><span class="op">)</span>

<span class="co">#simstep</span>
<span class="va">sims5m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_cycle3</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans2</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims5m2</span>, file<span class="op">=</span><span class="st">"sims5m2.Rdata"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="counting-dyads-1">4.3. Counting dyads<a class="anchor" aria-label="anchor" href="#counting-dyads-1"></a>
</h3>
<div class="section level4">
<h4 id="rsiena-1">4.3.1. RSiena<a class="anchor" aria-label="anchor" href="#rsiena-1"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>gofi <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans2,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                 DyadCensus.sna, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">join =</span> <span class="cn">TRUE</span>, </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">varName =</span> <span class="st">"mynet"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Calculating auxiliary statistics for period  1 .</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &gt; Completed  100  calculations</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">200</span>  calculations</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">300</span>  calculations</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">400</span>  calculations</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">500</span>  calculations</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">600</span>  calculations</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">700</span>  calculations</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">800</span>  calculations</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">900</span>  calculations</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">1000</span>  calculations</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">1000</span>  calculations</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gofi</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Simulations</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dfrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mut"</span>, <span class="st">"Asym"</span>, <span class="st">"Null"</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfrs</span>, <span class="va">dfrs</span>, <span class="va">dfrs</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mut"</span>, <span class="st">"asym"</span>, <span class="st">"null"</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dfrs</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"mut"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Mut</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"mut"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"asym"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Asym</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"asym"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"null"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Null</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"null"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"rsiena"</span>
<span class="va">dfrs_sienam2</span> <span class="op">&lt;-</span> <span class="va">df</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"dfrs"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rsienatwostep-1">4.3.2. RsienaTwoStep<a class="anchor" aria-label="anchor" href="#rsienatwostep-1"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ts1m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m2</span>, simtype<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span> 
<span class="va">df_ts2m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims2m2</span>, simtype<span class="op">=</span><span class="st">"twostep-simultaneity"</span><span class="op">)</span>
<span class="va">df_ts3m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims3m2</span>, simtype<span class="op">=</span><span class="st">"twostep-weak coordination"</span><span class="op">)</span> 
<span class="va">df_ts4m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims4m2</span>, simtype<span class="op">=</span><span class="st">"twostep-strict coordination"</span><span class="op">)</span>
<span class="va">df_ts5m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims5m2</span>, simtype<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="plotting-dyad_census-1">4.4. Plotting dyad_census<a class="anchor" aria-label="anchor" href="#plotting-dyad_census-1"></a>
</h3>
<div class="section level4">
<h4 id="all-three-dyad-types-1">4.4.1. All three dyad types<a class="anchor" aria-label="anchor" href="#all-three-dyad-types-1"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfrs_sienam2</span>, <span class="va">df_ts1m2</span>, <span class="va">df_ts2m2</span>, <span class="va">df_ts3m2</span>, <span class="va">df_ts4m2</span>, <span class="va">df_ts5m2</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"dyad type"</span>, y <span class="op">=</span> <span class="st">"dyad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-30-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="plotting-dyad-census-selection-1">4.4.2. Plotting dyad census selection<a class="anchor" aria-label="anchor" href="#plotting-dyad-census-selection-1"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">!=</span><span class="st">"null"</span>, <span class="op">]</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"dyad type"</span>, y <span class="op">=</span> <span class="st">"dyad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-31-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="counting-triads">4.5. Counting triads<a class="anchor" aria-label="anchor" href="#counting-triads"></a>
</h3>
<div class="section level4">
<h4 id="rsiena-2">4.5.1. RSiena<a class="anchor" aria-label="anchor" href="#rsiena-2"></a>
</h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>nsims <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>gofi <span class="ot">&lt;-</span> <span class="fu">sienaGOF</span>(ans2,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                 TriadCensus.sna, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">join =</span> <span class="cn">TRUE</span>, </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">varName =</span> <span class="st">"mynet"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Calculating auxiliary statistics for period  1 .</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &gt; Completed  100  calculations</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">200</span>  calculations</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">300</span>  calculations</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">400</span>  calculations</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">500</span>  calculations</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">600</span>  calculations</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">700</span>  calculations</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">800</span>  calculations</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">900</span>  calculations</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">1000</span>  calculations</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="sc">&gt;</span> Completed  <span class="dv">1000</span>  calculations</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>dfrs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gofi[[<span class="dv">1</span>]]<span class="sc">$</span>Simulations)</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>triads <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"003"</span>,  <span class="st">"012"</span>,  <span class="st">"102"</span> , <span class="st">"021D"</span>, <span class="st">"021U"</span>, <span class="st">"021C"</span> ,<span class="st">"111D"</span>, <span class="st">"111U"</span> ,<span class="st">"030T"</span> ,<span class="st">"030C"</span>, <span class="st">"201"</span>  ,<span class="st">"120D"</span> ,<span class="st">"120U"</span> ,<span class="st">"120C"</span> ,<span class="st">"210"</span>,  <span class="st">"300"</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dfrs) <span class="ot">&lt;-</span> triads</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>dflist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(triads)) {</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  dflist[[i]] <span class="ot">&lt;-</span> dfrs</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>dfrs <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, dflist)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>dfrs<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(triads, <span class="at">each=</span>nsims)</span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>dfrs<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(triads)) {</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  dfrs<span class="sc">$</span>y[dfrs<span class="sc">$</span>x<span class="sc">==</span>triads[i]] <span class="ot">&lt;-</span> dfrs[,triads[i]][dfrs<span class="sc">$</span>x<span class="sc">==</span>triads[i]]</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>dfrs<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"rsiena"</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>dfrs_sienam2 <span class="ot">&lt;-</span> dfrs</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rsienatwostep-2">4.5.2 RsienaTwoStep<a class="anchor" aria-label="anchor" href="#rsienatwostep-2"></a>
</h4>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ts1m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m2</span>, simtype<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span> 
<span class="va">df_ts2m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims2m2</span>, simtype<span class="op">=</span><span class="st">"twostep-simultaneity"</span><span class="op">)</span>
<span class="va">df_ts3m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims3m2</span>, simtype<span class="op">=</span><span class="st">"twostep-weak coordination"</span><span class="op">)</span> 
<span class="va">df_ts4m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims4m2</span>, simtype<span class="op">=</span><span class="st">"twostep-strict coordination"</span><span class="op">)</span>
<span class="va">df_ts5m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims5m2</span>, simtype<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="plotting-triad-census">4.6. Plotting triad census<a class="anchor" aria-label="anchor" href="#plotting-triad-census"></a>
</h3>
<div class="section level4">
<h4 id="all-triad-types">4.6.1. All triad types<a class="anchor" aria-label="anchor" href="#all-triad-types"></a>
</h4>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfrs_sienam2</span>, <span class="va">df_ts1m2</span>, <span class="va">df_ts2m2</span>, <span class="va">df_ts3m2</span>, <span class="va">df_ts4m2</span>, <span class="va">df_ts5m2</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"triad type"</span>, y <span class="op">=</span> <span class="st">"triad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-34-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="plotting-triad-census-selection-i">4.6.2 Plotting triad census selection I<a class="anchor" aria-label="anchor" href="#plotting-triad-census-selection-i"></a>
</h4>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"030C"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"120C"</span>,<span class="op">]</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"(cyclic) triad types"</span>, y <span class="op">=</span> <span class="st">"triad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-35-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="plotting-triad-census-selection-ii">4.6.3 Plotting triad census selection II<a class="anchor" aria-label="anchor" href="#plotting-triad-census-selection-ii"></a>
</h4>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"210"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"300"</span>,<span class="op">]</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"(cyclic) triad types"</span>, y <span class="op">=</span> <span class="st">"triad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-36-1.png" width="700"></p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="model-3-degree-reciprocity-transitive-triplets-3cycle-smoke-similarity-alcohol-alter-alcohol-ego-alcohol-ego-x-alcohol-alter">5. Model 3: Degree, reciprocity, transitive triplets, 3cycle, smoke
similarity, alcohol alter, alcohol ego, alcohol ego X alcohol alter<a class="anchor" aria-label="anchor" href="#model-3-degree-reciprocity-transitive-triplets-3cycle-smoke-similarity-alcohol-alter-alcohol-ego-alcohol-ego-x-alcohol-alter"></a>
</h2>
<div class="section level3">
<h3 id="running-siena07-2">5.1. Running `Siena07()<a class="anchor" aria-label="anchor" href="#running-siena07-2"></a>
</h3>
<p>preparing the dataset</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mynet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDependent.html" class="external-link">sienaDependent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">s501</span>, <span class="va">s502</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">alcohol</span> <span class="op">&lt;-</span> <span class="va">s50a</span>
<span class="va">smoke</span> <span class="op">&lt;-</span> <span class="va">s50s</span>
<span class="va">smoke</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/coCovar.html" class="external-link">coCovar</a></span><span class="op">(</span><span class="va">smoke</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="va">alcohol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/coCovar.html" class="external-link">coCovar</a></span><span class="op">(</span><span class="va">alcohol</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaDataCreate.html" class="external-link">sienaDataCreate</a></span><span class="op">(</span><span class="va">mynet</span>, <span class="va">smoke</span>, <span class="va">alcohol</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">myalgorithm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaAlgorithmCreate.html" class="external-link">sienaAlgorithmCreate</a></span><span class="op">(</span>seed<span class="op">=</span><span class="fl">1293</span>, cond<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co">#toggle set conditional to retrieve the rate parameter in theta!</span>
<span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/getEffects.html" class="external-link">getEffects</a></span><span class="op">(</span><span class="va">mydata</span><span class="op">)</span>
<span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">transTrip</span>, <span class="va">cycle3</span><span class="op">)</span>
<span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">egoX</span>, <span class="va">altX</span>, <span class="va">egoXaltX</span>, interaction1 <span class="op">=</span> <span class="st">"alcohol"</span><span class="op">)</span>
<span class="va">myeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/includeEffects.html" class="external-link">includeEffects</a></span><span class="op">(</span><span class="va">myeff</span>, <span class="va">simX</span>, interaction1 <span class="op">=</span> <span class="st">"smoke"</span><span class="op">)</span>
<span class="va">ans3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/siena07.html" class="external-link">siena07</a></span><span class="op">(</span><span class="va">myalgorithm</span>, data<span class="op">=</span><span class="va">mydata</span>, effects<span class="op">=</span><span class="va">myeff</span>, batch<span class="op">=</span><span class="cn">TRUE</span>, returnDeps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">fsave</span><span class="op">(</span><span class="va">ans3</span>, file<span class="op">=</span><span class="st">"ans3.Rdata"</span><span class="op">)</span></code></pre></div>
<p>let’s have a look</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ans3</span>
<span class="co">#&gt; Estimates, standard errors and convergence t-ratios</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                       Estimate   Standard   Convergence </span>
<span class="co">#&gt;                                                    Error      t-ratio   </span>
<span class="co">#&gt;   1. rate basic rate parameter mynet   6.2011  ( 1.0407   )   -0.0099   </span>
<span class="co">#&gt;   2. eval outdegree (density)         -2.5285  ( 0.1509   )    0.0668   </span>
<span class="co">#&gt;   3. eval reciprocity                  2.0541  ( 0.2691   )    0.0757   </span>
<span class="co">#&gt;   4. eval transitive triplets          0.5575  ( 0.1737   )    0.1203   </span>
<span class="co">#&gt;   5. eval 3-cycles                     0.0448  ( 0.3510   )    0.1166   </span>
<span class="co">#&gt;   6. eval smoke similarity             0.3993  ( 0.2883   )   -0.0054   </span>
<span class="co">#&gt;   7. eval alcohol alter               -0.0767  ( 0.0956   )    0.0309   </span>
<span class="co">#&gt;   8. eval alcohol ego                  0.0383  ( 0.1044   )    0.0399   </span>
<span class="co">#&gt;   9. eval alcohol ego x alcohol alter  0.0997  ( 0.0723   )    0.0265   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Overall maximum convergence ratio:    0.1571 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Total of 2511 iteration steps.</span></code></pre></div>
<p>This result is not very interesting because the covariates do not
have an important impact on the selection processes.</p>
<p>Let us briefly demonstrate that our RsienaTwoStep simulation leads to
same network configurations</p>
</div>
<div class="section level3">
<h3 id="simulate-networks-via-rsienatwostep-2">5.2. Simulate networks via <code>RsienaTwoStep</code><a class="anchor" aria-label="anchor" href="#simulate-networks-via-rsienatwostep-2"></a>
</h3>
<p><span style="color: red;">These simulations took two days to complete
on a simple HP Elitebook 855 G7</span></p>
<p>Prepare dataset for RsienaTwoStep Simulations.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alcohol</span> <span class="op">&lt;-</span> <span class="va">s50a</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> 
<span class="va">smoke</span> <span class="op">&lt;-</span> <span class="va">s50s</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> 
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>alcohol<span class="op">=</span><span class="va">alcohol</span>, smoke<span class="op">=</span><span class="va">smoke</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#ministep</span>
<span class="va">sims1m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">100</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, ccovar<span class="op">=</span><span class="va">df</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_transTrip</span>, <span class="va">ts_cycle3</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_simX</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_altX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoXaltX</span>, <span class="st">"alcohol"</span><span class="op">)</span><span class="op">)</span>, parameters<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">fsave</span><span class="op">(</span><span class="va">sims1m3</span>, file<span class="op">=</span><span class="st">"sims1m3.Rdata"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="counting-dyads-2">5.3. Counting dyads<a class="anchor" aria-label="anchor" href="#counting-dyads-2"></a>
</h3>
<div class="section level4">
<h4 id="rsiena-3">5.3.1. RSiena<a class="anchor" aria-label="anchor" href="#rsiena-3"></a>
</h4>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gofi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaGOF.html" class="external-link">sienaGOF</a></span><span class="op">(</span><span class="va">ans3</span>,
                 <span class="va">DyadCensus.sna</span>, 
                 verbose <span class="op">=</span> <span class="cn">TRUE</span>,
                 join <span class="op">=</span> <span class="cn">TRUE</span>, 
                 cluster <span class="op">=</span> <span class="va">my.cluster</span>,
                 varName <span class="op">=</span> <span class="st">"mynet"</span><span class="op">)</span>
<span class="co">#&gt; Calculating auxiliary statistics for period  1 .</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gofi</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Simulations</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dfrs</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mut"</span>, <span class="st">"Asym"</span>, <span class="st">"Null"</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfrs</span>, <span class="va">dfrs</span>, <span class="va">dfrs</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mut"</span>, <span class="st">"asym"</span>, <span class="st">"null"</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dfrs</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span> <span class="op">&lt;-</span> <span class="cn">NA</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"mut"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Mut</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"mut"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"asym"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Asym</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"asym"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"null"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">Null</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"null"</span><span class="op">]</span>
<span class="va">df</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"rsiena"</span>
<span class="va">dfrs_sienam3</span> <span class="op">&lt;-</span> <span class="va">df</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"dfrs"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rsienatwostep-3">5.3.2. RsienaTwoStep<a class="anchor" aria-label="anchor" href="#rsienatwostep-3"></a>
</h4>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ts1m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m3</span>, simtype<span class="op">=</span><span class="st">"ministep"</span><span class="op">)</span> </code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfrs_sienam3</span>, <span class="va">df_ts1m3</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"dyad type"</span>, y <span class="op">=</span> <span class="st">"dyad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-48-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="assessing-segregation">5.4 Assessing segregation<a class="anchor" aria-label="anchor" href="#assessing-segregation"></a>
</h3>
<div class="section level4">
<h4 id="rsiena-4">5.4.1. Rsiena<a class="anchor" aria-label="anchor" href="#rsiena-4"></a>
</h4>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gofi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RSiena/man/sienaGOF.html" class="external-link">sienaGOF</a></span><span class="op">(</span><span class="va">ans3</span>,
                 <span class="va">Nacf.sna</span>, 
                 verbose <span class="op">=</span> <span class="cn">TRUE</span>,
                 join <span class="op">=</span> <span class="cn">TRUE</span>, 
                 cluster <span class="op">=</span> <span class="va">my.cluster</span>,
                 varName <span class="op">=</span> <span class="st">"mynet"</span>, 
                 cov<span class="op">=</span><span class="va">mydata</span><span class="op">$</span><span class="va">cCovars</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span>
<span class="co">#&gt; Detected 1000 iterations and 1 group.</span>
<span class="co">#&gt; Calculating auxiliary statistics for period  1 .</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gofi</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">Simulations</span><span class="op">)</span>
<span class="va">dfrs</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"rsiena"</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dfrs</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="rsienatwostep-4">5.4.2. RsienaTwoStep<a class="anchor" aria-label="anchor" href="#rsienatwostep-4"></a>
</h4>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ts1m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m3</span>, simtype<span class="op">=</span><span class="st">"ministep"</span>, cov<span class="op">=</span><span class="va">mydata</span><span class="op">$</span><span class="va">cCovars</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_ts1m3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span> </code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">dfrs</span>, <span class="va">df_ts1m3</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="va">MoranI</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rsiena"</span>, <span class="st">"ministep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"sim type"</span>, y <span class="op">=</span> <span class="st">"Smoke \n MoranI"</span>, fill<span class="op">=</span><span class="st">"sim type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-52-1.png" width="700">
Okay, it seems RsienaTwoStep is programmed correctly.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="model-4-model-3-with-smoke-segregation">6. Model 4: Model 3 with smoke segregation<a class="anchor" aria-label="anchor" href="#model-4-model-3-with-smoke-segregation"></a>
</h2>
<div class="section level3">
<h3 id="simulate-networks-via-rsienatwostep-3">6.1. Simulate networks via <code>RsienaTwoStep</code><a class="anchor" aria-label="anchor" href="#simulate-networks-via-rsienatwostep-3"></a>
</h3>
<p>Let us now, simulate a model with segregation. Or more precisely,
that pupils have a preference for a tie with someone with similar
smoking behavior. We take as starting point the estimates of
<code>ans3</code>.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>
<span class="va">est</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.8</span> <span class="co">#count carefully :-(</span>
<span class="va">est</span></code></pre></div>
<p>Now simulate under the different twostep conditions.</p>
<p>Prepare dataset for RsienaTwoStep Simulations (again).</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">alcohol</span> <span class="op">&lt;-</span> <span class="va">s50a</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> 
<span class="va">smoke</span> <span class="op">&lt;-</span> <span class="va">s50s</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> 
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>alcohol<span class="op">=</span><span class="va">alcohol</span>, smoke<span class="op">=</span><span class="va">smoke</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sims1m3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">100</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, ccovar<span class="op">=</span><span class="va">df</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_transTrip</span>, <span class="va">ts_cycle3</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_simX</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_altX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoXaltX</span>, <span class="st">"alcohol"</span><span class="op">)</span><span class="op">)</span>, parameters<span class="op">=</span><span class="va">est</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">fsave</span><span class="op">(</span><span class="va">sims1m3b</span>, file<span class="op">=</span><span class="st">"sims1m3b.Rdata"</span><span class="op">)</span>

<span class="co">#simultaneity</span>
<span class="va">sims2m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">100</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, ccovar<span class="op">=</span><span class="va">df</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_transTrip</span>, <span class="va">ts_cycle3</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_simX</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_altX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoXaltX</span>, <span class="st">"alcohol"</span><span class="op">)</span><span class="op">)</span>, parameters<span class="op">=</span><span class="va">est</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims2m3</span>, file<span class="op">=</span><span class="st">"sims2m3.Rdata"</span><span class="op">)</span>

<span class="co">#weak coordination</span>
<span class="va">sims3m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">100</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, ccovar<span class="op">=</span><span class="va">df</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_transTrip</span>, <span class="va">ts_cycle3</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_simX</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_altX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoXaltX</span>, <span class="st">"alcohol"</span><span class="op">)</span><span class="op">)</span>, parameters<span class="op">=</span><span class="va">est</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1<span class="op">=</span><span class="fl">2</span>, dist2<span class="op">=</span><span class="fl">2</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims3m3</span>, file<span class="op">=</span><span class="st">"sims3m3.Rdata"</span><span class="op">)</span>

<span class="co">#strict coordination</span>
<span class="va">sims4m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">100</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, ccovar<span class="op">=</span><span class="va">df</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_transTrip</span>, <span class="va">ts_cycle3</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_simX</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_altX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoXaltX</span>, <span class="st">"alcohol"</span><span class="op">)</span><span class="op">)</span>, parameters<span class="op">=</span><span class="va">est</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span>, dist1<span class="op">=</span><span class="fl">2</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims4m3</span>, file<span class="op">=</span><span class="st">"sims4m3.Rdata"</span><span class="op">)</span>

<span class="co">#simstep</span>
<span class="va">sims5m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_sims.html">ts_sims</a></span><span class="op">(</span>nsims<span class="op">=</span><span class="fl">100</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, net<span class="op">=</span><span class="va">s501</span>, ccovar<span class="op">=</span><span class="va">df</span>, rate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ans3</span><span class="op">)</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, statistics<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_degree</span>, <span class="va">ts_recip</span>, <span class="va">ts_transTrip</span>, <span class="va">ts_cycle3</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_simX</span>, <span class="st">"smoke"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_altX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoX</span>, <span class="st">"alcohol"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ts_egoXaltX</span>, <span class="st">"alcohol"</span><span class="op">)</span><span class="op">)</span>, parameters<span class="op">=</span><span class="va">est</span>, p2step<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, chain<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">fsave</span><span class="op">(</span><span class="va">sims5m3</span>, file<span class="op">=</span><span class="st">"sims5m3.Rdata"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="counting-dyads-rsienatwostep">6.2 counting dyads RsienaTwoStep<a class="anchor" aria-label="anchor" href="#counting-dyads-rsienatwostep"></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ts1m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m3</span>, simtype<span class="op">=</span><span class="st">"ministep-original"</span><span class="op">)</span> 
<span class="va">df_ts1m3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m3b</span>, simtype<span class="op">=</span><span class="st">"ministep-with segregation"</span><span class="op">)</span> 
<span class="va">df_ts2m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims2m3</span>, simtype<span class="op">=</span><span class="st">"twostep-simultaneity"</span><span class="op">)</span> 
<span class="va">df_ts3m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims3m3</span>, simtype<span class="op">=</span><span class="st">"twostep-weak coordination"</span><span class="op">)</span> 
<span class="va">df_ts4m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims4m3</span>, simtype<span class="op">=</span> <span class="st">"twostep-strict coordination"</span><span class="op">)</span> 
<span class="va">df_ts5m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_dyads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims5m3</span>, simtype<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span> </code></pre></div>
<div class="section level4">
<h4 id="plotting-all-dyads">6.2.1 Plotting all dyads<a class="anchor" aria-label="anchor" href="#plotting-all-dyads"></a>
</h4>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_ts1m3</span>, <span class="va">df_ts1m3b</span>, <span class="va">df_ts2m3</span>, <span class="va">df_ts3m3</span>, <span class="va">df_ts4m3</span>, <span class="va">df_ts5m3</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep-original"</span>, <span class="st">"ministep-with segregation"</span>, <span class="st">"twostep-simultaneity"</span>,<span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>,<span class="st">"simstep"</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"dyad type"</span>, y <span class="op">=</span> <span class="st">"dyad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-58-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="plotting-dyads-selection">6.2.1 Plotting dyads selection<a class="anchor" aria-label="anchor" href="#plotting-dyads-selection"></a>
</h4>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"asym"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"mut"</span>,<span class="op">]</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep-original"</span>, <span class="st">"ministep-with segregation"</span>, <span class="st">"twostep-simultaneity"</span>,<span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>,<span class="st">"simstep"</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"dyad type"</span>, y <span class="op">=</span> <span class="st">"dyad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-59-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="counting-triads-rsienatwostep">6.3 counting triads RsienaTwoStep<a class="anchor" aria-label="anchor" href="#counting-triads-rsienatwostep"></a>
</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ts1m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m3</span>, simtype<span class="op">=</span><span class="st">"ministep-original"</span><span class="op">)</span> 
<span class="va">df_ts1m3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m3b</span>, simtype<span class="op">=</span><span class="st">"ministep-with segregation"</span><span class="op">)</span> 
<span class="va">df_ts2m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims2m3</span>, simtype<span class="op">=</span><span class="st">"twostep-simultaneity"</span><span class="op">)</span> 
<span class="va">df_ts3m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims3m3</span>, simtype<span class="op">=</span><span class="st">"twostep-weak coordination"</span><span class="op">)</span> 
<span class="va">df_ts4m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims4m3</span>, simtype<span class="op">=</span> <span class="st">"twostep-strict coordination"</span><span class="op">)</span> 
<span class="va">df_ts5m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_triads</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims5m3</span>, simtype<span class="op">=</span><span class="st">"simstep"</span><span class="op">)</span> </code></pre></div>
<div class="section level4">
<h4 id="plotting-all-triad-types">6.3.1. Plotting all triad types<a class="anchor" aria-label="anchor" href="#plotting-all-triad-types"></a>
</h4>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_ts1m3</span>, <span class="va">df_ts1m3b</span>, <span class="va">df_ts2m3</span>, <span class="va">df_ts3m3</span>, <span class="va">df_ts4m3</span>, <span class="va">df_ts5m3</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep-original"</span>, <span class="st">"ministep-with segregation"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"triad type"</span>, y <span class="op">=</span> <span class="st">"triad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-61-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="plotting-triad-census-selection-i-1">6.3.2 Plotting triad census selection I<a class="anchor" aria-label="anchor" href="#plotting-triad-census-selection-i-1"></a>
</h4>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"030C"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"120C"</span>,<span class="op">]</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep-original"</span>, <span class="st">"ministep-with segregation"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"(cyclic) triad types"</span>, y <span class="op">=</span> <span class="st">"triad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-62-1.png" width="700">
### 6.3.3 Plotting triad census selection II</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_sel</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"210"</span> <span class="op">|</span> <span class="va">df</span><span class="op">$</span><span class="va">x</span><span class="op">==</span><span class="st">"300"</span>,<span class="op">]</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df_sel</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep-original"</span>, <span class="st">"ministep-with segregation"</span>, <span class="st">"twostep-simultaneity"</span>, <span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>, <span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"(cyclic) triad types"</span>, y <span class="op">=</span> <span class="st">"triad count"</span>, fill<span class="op">=</span><span class="st">"simulation type"</span><span class="op">)</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-63-1.png" width="700"></p>
</div>
</div>
<div class="section level3">
<h3 id="assessing-segregation-rsienatwostep">6.4 Assessing segregation RsienaTwoStep<a class="anchor" aria-label="anchor" href="#assessing-segregation-rsienatwostep"></a>
</h3>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df_ts1m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m3</span>, simtype<span class="op">=</span><span class="st">"ministep-original"</span>, cov<span class="op">=</span><span class="va">mydata</span><span class="op">$</span><span class="va">cCovars</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_ts1m3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span> 
<span class="va">df_ts1m3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims1m3b</span>, simtype<span class="op">=</span><span class="st">"ministep-with segregation"</span>, cov<span class="op">=</span><span class="va">mydata</span><span class="op">$</span><span class="va">cCovars</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_ts1m3b</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span> 
<span class="va">df_ts2m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims2m3</span>, simtype<span class="op">=</span><span class="st">"twostep-simultaneity"</span>, cov<span class="op">=</span><span class="va">mydata</span><span class="op">$</span><span class="va">cCovars</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_ts2m3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span> 
<span class="va">df_ts3m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims3m3</span>, simtype<span class="op">=</span><span class="st">"twostep-weak coordination"</span>, cov<span class="op">=</span><span class="va">mydata</span><span class="op">$</span><span class="va">cCovars</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_ts3m3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span> 
<span class="va">df_ts4m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims4m3</span>, simtype<span class="op">=</span><span class="st">"twostep-strict coordination"</span>, cov<span class="op">=</span><span class="va">mydata</span><span class="op">$</span><span class="va">cCovars</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_ts4m3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span> 
<span class="va">df_ts5m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ts_dyads.html">ts_nacf</a></span><span class="op">(</span>sims<span class="op">=</span><span class="va">sims5m3</span>, simtype<span class="op">=</span><span class="st">"simstep"</span>, cov<span class="op">=</span><span class="va">mydata</span><span class="op">$</span><span class="va">cCovars</span><span class="op">$</span><span class="va">smoke</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_ts5m3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"MoranI"</span> </code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_ts1m3</span>, <span class="va">df_ts1m3b</span>, <span class="va">df_ts2m3</span>, <span class="va">df_ts3m3</span>, <span class="va">df_ts4m3</span>, <span class="va">df_ts5m3</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span> , levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep-original"</span>, <span class="st">"ministep-with segregation"</span>, <span class="st">"twostep-simultaneity"</span>,<span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>,<span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span>, y<span class="op">=</span><span class="va">MoranI</span>, fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">type</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ministep-original"</span>, <span class="st">"ministep-with segregation"</span>, <span class="st">"twostep-simultaneity"</span>,<span class="st">"twostep-weak coordination"</span>, <span class="st">"twostep-strict coordination"</span>,<span class="st">"simstep"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_violin</span><span class="op">(</span>position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"errorbar"</span>,
               fun.max <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               fun.min <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
               width<span class="op">=</span><span class="fl">.1</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">stat_summary</span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               color<span class="op">=</span><span class="st">"red"</span>, position<span class="op">=</span><span class="fu">position_dodge</span><span class="op">(</span><span class="fl">.8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"sim type"</span>, y <span class="op">=</span> <span class="st">"Smoke \n MoranI"</span>, fill<span class="op">=</span><span class="st">"sim type"</span><span class="op">)</span>  <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>axis.text.x<span class="op">=</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
        
<span class="co">#  labs(x = "sim type", y = "Smoke \n MoranI", fill="sim type") </span>
<span class="co">#+</span>
<span class="co">#  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))</span>

<span class="va">p</span></code></pre></div>
<p><img src="RsienaWorkflow_files/figure-html/unnamed-chunk-65-1.png" width="700"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">7. Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<ul>
<li>The networks simulated by <code>RsienaTwoStep</code> assuming the
ministep assumption lead to identical results as the simulated networks
of <code>RSiena</code>. We can hence conclude that (at least for the
used statistics) <code>RsienaTwoStep</code> is programmed
correctly.<br>
</li>
<li>For both model specifications, we observe that allowing for
simultaneity does not really impact the observed dyads and triads in the
network, although reciprocated ties seem a bit more likely. This is
reassuring. A tentative conclusion would be that for relatively sparse
and large networks it ‘does not matter’ to disregard simultaneous tie
changes.<br>
</li>
<li>Both forms of coordination (weak and strict) lead to more
reciprocated ties.<br>
</li>
<li>The dyad and triad census of the networks simulated assuming ‘weak
coordination’ deviate the most from the other simulated networks. The
assumption made under weak coordination is that also actors who are
<strong><span style="color: red;">not</span> connected at time
t0</strong> can initiate a coordinated tie-change. Hence, it is called
weak coordination. However, these actors only evaluate twostep tie
changes that lead to a connection at time t2. In other words, their
choice set is reduced.<br>
</li>
<li>Under strict coordination, it is assumed that only actors
<strong>connected at time t0</strong> can start a coordination. Hence,
it is called strict coordination. These actors evaluate all twostep tie
changes (also those that would be the result of two independent
ministeps). In our ABM we specified that there was only strict
coordination (parameter <code>p2step=c(0,1,0</code>). This will probably
mean that some actors made a lot more tie-changes than others. It may be
worthwhile to mix twosteps with ministeps and simsteps (i.e.,
<code>p2step=c(0.33,0.33,0.34)</code>).<br>
</li>
<li>Under the simstep assumption, we observe more asymmetric dyads.
This, intuitively makes sense, because you cannot make a reciprocated
tie all by yourself. More surprisingly is that also cyclic triads (030C
and 120C) seem to occur relatively often. Whether or not this is solely
the results of the abundance of asymetric dyads remains to be
investigated.</li>
</ul>
<hr>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jochem Tolsma.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
